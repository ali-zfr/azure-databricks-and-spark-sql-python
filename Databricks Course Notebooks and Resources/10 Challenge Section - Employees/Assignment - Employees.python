{"version":"NotebookV1","origId":1137724266867211,"name":"Assignment - Employees","language":"python","commands":[{"version":"CommandV1","origId":1137724266867212,"guid":"3372589e-d12d-4387-ac8a-355f6fc34acb","subtype":"command","commandType":"auto","position":2.0,"command":"%md\n# Assignment 2 - Employees (Solutions)","commandVersion":5,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"599c629c-2529-4dd0-a080-6a40cfaaa5fc"},{"version":"CommandV1","origId":1137724266867213,"guid":"81a44cf7-bd79-454b-b11f-1ef50e4329ef","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n#### 1. Mount the employees container to DBFS\n\nhttps://docs.databricks.com/dbfs/mounts.html","commandVersion":21,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e58267d5-9c21-4dcd-bc76-a6d11d4cb392"},{"version":"CommandV1","origId":1137724266867214,"guid":"0b48a3f9-caa5-4cf8-b6ed-3d396823f39d","subtype":"command","commandType":"auto","position":3.5,"command":"# insert your scope and key in the secrets.get method\n# ensure you have set up the secret scopes and stored your IDs and keys in the key vault\napplication_id = dbutils.secrets.get(scope='INSERT SCOPE HERE', key = 'INSERT APP ID HERE')\ntenant_id = dbutils.secrets.get(scope='INSERT SCOPE HERE', key = 'INSERT TENANT ID HERE')\nsecret = dbutils.secrets.get(scope='INSERT SCOPE HERE', key = 'INSERT SECRET HERE')","commandVersion":105,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128317889,"submitTime":1667128317866,"finishTime":1667128318207,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2f6766d4-0225-438a-9e01-c199d15ea6d6"},{"version":"CommandV1","origId":1137724266867215,"guid":"3b15ca94-ad2b-47a8-9a48-eef82aacc364","subtype":"command","commandType":"auto","position":4.0,"command":" # Ensure your secret is still valid, if it has expired you will have to re-generate the secret and store it in the key vault\n\nconfigs = {\"fs.azure.account.auth.type\": \"OAuth\",\n          \"fs.azure.account.oauth.provider.type\": \"org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider\",\n          \"fs.azure.account.oauth2.client.id\": application_id,\n          \"fs.azure.account.oauth2.client.secret\": secret,\n          \"fs.azure.account.oauth2.client.endpoint\": f\"https://login.microsoftonline.com/{tenant_id}/oauth2/token\"}\n\n# Optionally, you can add <directory-name> to the source URI of your mount point.\ndbutils.fs.mount(\n  source = \"abfss://employees@datalake639.dfs.core.windows.net/\",\n  mount_point = \"/mnt/employees\",\n  extra_configs = configs)","commandVersion":49,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[6]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128326887,"submitTime":1667128326862,"finishTime":1667128347711,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",39]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7105b342-b9ec-4c3b-96d4-5440cf7316b6"},{"version":"CommandV1","origId":1137724266867216,"guid":"b5568f59-d157-44ae-a4fa-dba345c5bb4a","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n#### 2. Adding parquet files to the silver folder of the employees container","commandVersion":13,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c8613fcf-774d-4f31-883f-50f2477aea53"},{"version":"CommandV1","origId":1137724266867217,"guid":"32b5472f-ea87-48b2-9395-8ca56ca45123","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n##### Employees","commandVersion":9,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0b472f42-96a3-4574-b6ec-1ff9092c3896"},{"version":"CommandV1","origId":1137724266867218,"guid":"c2ba7042-137d-4f12-89d7-e6110f980f5e","subtype":"command","commandType":"auto","position":7.0,"command":"# Importing the data types\nfrom pyspark.sql.types import IntegerType, StringType, DoubleType, StructField, StructType, DateType","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128425885,"submitTime":1667128425848,"finishTime":1667128425912,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d22ef508-1398-45d1-aa36-731ec48bc5e1"},{"version":"CommandV1","origId":1137724266867219,"guid":"e44de330-9d4a-4c4b-b330-a8c24c668955","subtype":"command","commandType":"auto","position":8.0,"command":"# Reading in the employees csv file from the bronze layer\n# Reading in the hire_date as a string to avoid formatting issues during the read operation\nemployees_path = '/mnt/employees/bronze/employees.csv'\n \n\nemployees_schema = StructType([\n                    StructField(\"EMPLOYEE_ID\", IntegerType(), False),\n                    StructField(\"FIRST_NAME\", StringType(), False),\n                    StructField(\"LAST_NAME\", StringType(), False),\n                    StructField(\"EMAIL\", StringType(), False),\n                    StructField(\"PHONE_NUMBER\", StringType(), False),\n                    StructField(\"HIRE_DATE\", StringType(), False),\n                    StructField(\"JOB_ID\", StringType(), False),\n                    StructField(\"SALARY\", IntegerType(), False),\n                    StructField(\"MANAGER_ID\", IntegerType(), True),\n                    StructField(\"DEPARTMENT_ID\", IntegerType(), False)\n                    ]\n                    )\n \nemployees=spark.read.csv(path=employees_path, header=True, schema=employees_schema)","commandVersion":71,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employees","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"EMPLOYEE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"FIRST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"LAST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"EMAIL","nullable":true,"type":"string"},{"metadata":{},"name":"PHONE_NUMBER","nullable":true,"type":"string"},{"metadata":{},"name":"HIRE_DATE","nullable":true,"type":"string"},{"metadata":{},"name":"JOB_ID","nullable":true,"type":"string"},{"metadata":{},"name":"SALARY","nullable":true,"type":"integer"},{"metadata":{},"name":"MANAGER_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_ID","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128448389,"submitTime":1667128448364,"finishTime":1667128449818,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bf4f6498-98be-45b0-b79d-9f77aa7c295d"},{"version":"CommandV1","origId":1137724266867220,"guid":"b5127d03-29e1-488f-a2a6-1b58a1c3c4fa","subtype":"command","commandType":"auto","position":9.0,"command":"employees.display()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[100,"Steven","King","SKING","515.123.4567","09/01/2009","AD_PRES",24000,null,90],[101,"Neena","Kochhar","NKOCHHAR","515.123.4568","12/07/2011","AD_VP",17000,100,90],[102,"Lex","De Haan","LDEHAAN","515.123.4569","03/31/2015","AD_VP",17000,100,90],[103,"Alexander","Hunold","AHUNOLD","590.423.4567","03/20/2012","IT_PROG",9000,102,60],[104,"Bruce","Ernst","BERNST","590.423.4568","08/05/2013","IT_PROG",6000,103,60],[105,"David","Austin","DAUSTIN","590.423.4569","09/10/2019","IT_PROG",4800,103,60],[106,"Valli","Pataballa","VPATABAL","590.423.4560","04/22/2020","IT_PROG",4800,103,60],[107,"Diana","Lorentz","DLORENTZ","590.423.5567","04/24/2021","IT_PROG",4200,103,60],[108,"Nancy","Greenberg","NGREENBE","515.124.4569","11/01/2016","FI_MGR",12000,101,100],[109,"Daniel","Faviet","DFAVIET","515.124.4169","10/31/2016","FI_ACCOUNT",9000,108,100],[110,"John","Chen","JCHEN","515.124.4269","12/14/2019","FI_ACCOUNT",8200,108,100],[111,"Ismael","Sciarra","ISCIARRA","515.124.4369","12/16/2019","FI_ACCOUNT",7700,108,100],[112,"Jose Manuel","Urman","JMURMAN","515.124.4469","05/22/2020","FI_ACCOUNT",7800,108,100],[113,"Luis","Popp","LPOPP","515.124.4567","02/21/2022","FI_ACCOUNT",6900,108,100],[114,"Den","Raphaely","DRAPHEAL","515.127.4561","02/21/2017","PU_MAN",11000,100,30],[115,"Alexander","Khoo","AKHOO","515.127.4562","08/02/2017","PU_CLERK",3100,114,30],[116,"Shelli","Baida","SBAIDA","515.127.4563","03/10/2020","PU_CLERK",2900,114,30],[117,"Sigal","Tobias","STOBIAS","515.127.4564","10/09/2019","PU_CLERK",2800,114,30],[118,"Guy","Himuro","GHIMURO","515.127.4565","01/30/2021","PU_CLERK",2600,114,30],[119,"Karen","Colmenares","KCOLMENA","515.127.4566","10/25/2021","PU_CLERK",2500,114,30],[120,"Matthew","Weiss","MWEISS","650.123.1234","10/03/2018","ST_MAN",8000,100,50],[121,"Adam","Fripp","AFRIPP","650.123.2234","06/26/2019","ST_MAN",8200,100,50],[122,"Payam","Kaufling","PKAUFLIN","650.123.3234","07/16/2017","ST_MAN",7900,100,50],[123,"Shanta","Vollman","SVOLLMAN","650.123.4234","12/26/2019","ST_MAN",6500,100,50],[124,"Kevin","Mourgos","KMOURGOS","650.123.5234","01/31/2022","ST_MAN",5800,100,50],[125,"Julia","Nayer","JNAYER","650.124.1214","10/01/2019","ST_CLERK",3200,120,50],[126,"Irene","Mikkilineni","IMIKKILI","650.124.1224","12/13/2020","ST_CLERK",2700,120,50],[127,"James","Landry","JLANDRY","650.124.1334","03/31/2021","ST_CLERK",2400,120,50],[128,"Steven","Markle","SMARKLE","650.124.1434","05/24/2022","ST_CLERK",2200,120,50],[129,"Laura","Bissot","LBISSOT","650.124.5234","11/05/2019","ST_CLERK",3300,121,50],[130,"Mozhe","Atkinson","MATKINSO","650.124.6234","01/15/2020","ST_CLERK",2800,121,50],[131,"James","Marlow","JAMRLOW","650.124.7234","05/04/2019","ST_CLERK",2500,121,50],[132,"TJ","Olson","TJOLSON","650.124.8234","06/25/2021","ST_CLERK",2100,121,50],[133,"Jason","Mallin","JMALLIN","650.127.1934","08/30/2018","ST_CLERK",3300,122,50],[134,"Michael","Rogers","MROGERS","650.127.1834","11/10/2020","ST_CLERK",2900,122,50],[135,"Ki","Gee","KGEE","650.127.1734","02/26/2022","ST_CLERK",2400,122,50],[136,"Hazel","Philtanker","HPHILTAN","650.127.1634","04/23/2022","ST_CLERK",2200,122,50],[137,"Renske","Ladwig","RLADWIG","650.121.1234","09/28/2017","ST_CLERK",3600,123,50],[138,"Stephen","Stiles","SSTILES","650.121.2034","01/11/2020","ST_CLERK",3200,123,50],[139,"John","Seo","JSEO","650.121.2019","04/29/2020","ST_CLERK",2700,123,50],[140,"Joshua","Patel","JPATEL","650.121.1834","06/21/2020","ST_CLERK",2500,123,50],[141,"Trenna","Rajs","TRAJS","650.121.8009","01/01/2018","ST_CLERK",3500,124,50],[142,"Curtis","Davies","CDAVIES","650.121.2994","04/16/2019","ST_CLERK",3100,124,50],[143,"Randall","Matos","RMATOS","650.121.2874","05/30/2020","ST_CLERK",2600,124,50],[144,"Peter","Vargas","PVARGAS","650.121.2004","09/23/2020","ST_CLERK",2500,124,50],[145,"John","Russell","JRUSSEL","011.44.1344.429268","12/17/2018","SA_MAN",14000,100,80],[146,"Karen","Partners","KPARTNER","011.44.1344.467268","03/23/2019","SA_MAN",13500,100,80],[147,"Alberto","Errazuriz","AERRAZUR","011.44.1344.429278","05/26/2019","SA_MAN",12000,100,80],[148,"Gerald","Cambrault","GCAMBRAU","011.44.1344.619268","12/30/2021","SA_MAN",11000,100,80],[149,"Eleni","Zlotkey","EZLOTKEY","011.44.1344.429018","04/15/2022","SA_MAN",10500,100,80],[150,"Peter","Tucker","PTUCKER","011.44.1344.129268","04/17/2019","SA_REP",10000,145,80],[151,"David","Bernstein","DBERNSTE","011.44.1344.345268","06/09/2019","SA_REP",9500,145,80],[152,"Peter","Hall","PHALL","011.44.1344.478968","11/05/2019","SA_REP",9000,145,80],[153,"Christopher","Olsen","COLSEN","011.44.1344.498718","06/14/2020","SA_REP",8000,145,80],[154,"Nanette","Cambrault","NCAMBRAU","011.44.1344.987668","02/23/2021","SA_REP",7500,145,80],[155,"Oliver","Tuvault","OTUVAULT","011.44.1344.486508","02/07/2022","SA_REP",7000,145,80],[156,"Janette","King","JKING","011.44.1345.429268","04/16/2018","SA_REP",10000,146,80],[157,"Patrick","Sully","PSULLY","011.44.1345.929268","05/20/2018","SA_REP",9500,146,80],[158,"Allan","McEwen","AMCEWEN","011.44.1345.829268","10/17/2018","SA_REP",9000,146,80],[159,"Lindsey","Smith","LSMITH","011.44.1345.729268","05/26/2019","SA_REP",8000,146,80],[160,"Louise","Doran","LDORAN","011.44.1345.629268","03/01/2020","SA_REP",7500,146,80],[161,"Sarath","Sewall","SSEWALL","011.44.1345.529268","01/18/2021","SA_REP",7000,146,80],[162,"Clara","Vishney","CVISHNEY","011.44.1346.129268","01/27/2020","SA_REP",10500,147,80],[163,"Danielle","Greene","DGREENE","011.44.1346.229268","06/03/2021","SA_REP",9500,147,80],[164,"Mattea","Marvins","MMARVINS","011.44.1346.329268","04/10/2022","SA_REP",7200,147,80],[165,"David","Lee","DLEE","011.44.1346.529268","05/10/2022","SA_REP",6800,147,80],[166,"Sundar","Ande","SANDE","011.44.1346.629268","06/09/2022","SA_REP",6400,147,80],[167,"Amit","Banda","ABANDA","011.44.1346.729268","07/07/2022","SA_REP",6200,147,80],[168,"Lisa","Ozer","LOZER","011.44.1343.929268","05/27/2019","SA_REP",11500,148,80],[169,"Harrison","Bloom","HBLOOM","011.44.1343.829268","06/07/2020","SA_REP",10000,148,80],[170,"Tayler","Fox","TFOX","011.44.1343.729268","04/10/2020","SA_REP",9600,148,80],[171,"William","Smith","WSMITH","011.44.1343.629268","05/10/2021","SA_REP",7400,148,80],[172,"Elizabeth","Bates","EBATES","011.44.1343.529268","06/08/2021","SA_REP",7300,148,80],[173,"Sundita","Kumar","SKUMAR","011.44.1343.329268","07/07/2022","SA_REP",6100,148,80],[174,"Ellen","Abel","EABEL","011.44.1644.429267","07/27/2018","SA_REP",11000,149,80],[175,"Alyssa","Hutton","AHUTTON","011.44.1644.429266","06/04/2019","SA_REP",8800,149,80],[176,"Jonathon","Taylor","JTAYLOR","011.44.1644.429265","06/08/2020","SA_REP",8600,149,80],[177,"Jack","Livingston","JLIVINGS","011.44.1644.429264","07/08/2020","SA_REP",8400,149,80],[178,"Kimberely","Grant","KGRANT","011.44.1644.429263","08/08/2021","SA_REP",7000,149,null],[179,"Charles","Johnson","CJOHNSON","011.44.1644.429262","03/21/2022","SA_REP",6200,149,80],[180,"Winston","Taylor","WTAYLOR","650.507.9876","04/10/2020","SH_CLERK",3200,120,50],[181,"Jean","Fleaur","JFLEAUR","650.507.9877","05/10/2020","SH_CLERK",3100,120,50],[182,"Martha","Sullivan","MSULLIVA","650.507.9878","09/05/2021","SH_CLERK",2500,120,50],[183,"Girard","Geoni","GGEONI","650.507.9879","04/20/2022","SH_CLERK",2800,120,50],[184,"Nandita","Sarchand","NSARCHAN","650.509.1876","04/13/2018","SH_CLERK",4200,121,50],[185,"Alexis","Bull","ABULL","650.509.2876","05/08/2019","SH_CLERK",4100,121,50],[186,"Julia","Dellinger","JDELLING","650.509.3876","09/08/2020","SH_CLERK",3400,121,50],[187,"Anthony","Cabrio","ACABRIO","650.509.4876","04/24/2021","SH_CLERK",3000,121,50],[188,"Kelly","Chung","KCHUNG","650.505.1876","08/30/2019","SH_CLERK",3800,122,50],[189,"Jennifer","Dilly","JDILLY","650.505.2876","10/29/2019","SH_CLERK",3600,122,50],[190,"Timothy","Gates","TGATES","650.505.3876","09/25/2020","SH_CLERK",2900,122,50],[191,"Randall","Perkins","RPERKINS","650.505.4876","03/05/2022","SH_CLERK",2500,122,50],[192,"Sarah","Bell","SBELL","650.501.1876","04/21/2018","SH_CLERK",4000,123,50],[193,"Britney","Everett","BEVERETT","650.501.2876","05/19/2019","SH_CLERK",3900,123,50],[194,"Samuel","McCain","SMCCAIN","650.501.3876","09/15/2020","SH_CLERK",3200,123,50],[195,"Vance","Jones","VJONES","650.501.4876","06/01/2021","SH_CLERK",2800,123,50],[196,"Alana","Walsh","AWALSH","650.507.9811","07/09/2020","SH_CLERK",3100,124,50],[197,"Kevin","Feeney","KFEENEY","650.507.9822","08/07/2020","SH_CLERK",3000,124,50],[198,"Donald","OConnell","DOCONNEL","650.507.9833","09/05/2021","SH_CLERK",2600,124,50],[199,"Douglas","Grant","DGRANT","650.507.9844","03/30/2022","SH_CLERK",2600,124,50],[200,"Jennifer","Whalen","JWHALEN","515.123.4444","12/02/2009","AD_ASST",4400,101,10],[201,"Michael","Hartstein","MHARTSTE","515.123.5555","05/04/2018","MK_MAN",13000,100,20],[202,"Pat","Fay","PFAY","603.123.6666","11/02/2019","MK_REP",6000,201,20],[203,"Susan","Mavris","SMAVRIS","515.123.7777","08/22/2016","HR_REP",6500,101,40],[204,"Hermann","Baer","HBAER","515.123.8888","08/22/2016","PR_REP",10000,101,70],[205,"Shelley","Higgins","SHIGGINS","515.123.8080","08/22/2016","AC_MGR",12000,101,110],[206,"William","Gietz","WGIETZ","515.123.8181","08/22/2016","AC_ACCOUNT",8300,205,110]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"EMPLOYEE_ID","type":"\"integer\"","metadata":"{}"},{"name":"FIRST_NAME","type":"\"string\"","metadata":"{}"},{"name":"LAST_NAME","type":"\"string\"","metadata":"{}"},{"name":"EMAIL","type":"\"string\"","metadata":"{}"},{"name":"PHONE_NUMBER","type":"\"string\"","metadata":"{}"},{"name":"HIRE_DATE","type":"\"string\"","metadata":"{}"},{"name":"JOB_ID","type":"\"string\"","metadata":"{}"},{"name":"SALARY","type":"\"integer\"","metadata":"{}"},{"name":"MANAGER_ID","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_ID","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128454787,"submitTime":1667128454762,"finishTime":1667128455759,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",107]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a58fd648-583c-4187-a61f-4adaf51b79c7"},{"version":"CommandV1","origId":1137724266867221,"guid":"f1e924ae-99fb-4db6-8e4f-acd78c7f8d9d","subtype":"command","commandType":"auto","position":10.0,"command":"# Dropping unnecessary columns\nemployees = employees.drop(\"EMAIL\", \"PHONE_NUMBER\")","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employees","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"EMPLOYEE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"FIRST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"LAST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"HIRE_DATE","nullable":true,"type":"string"},{"metadata":{},"name":"JOB_ID","nullable":true,"type":"string"},{"metadata":{},"name":"SALARY","nullable":true,"type":"integer"},{"metadata":{},"name":"MANAGER_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_ID","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128464081,"submitTime":1667128464057,"finishTime":1667128464127,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4f2b843c-e570-45ec-a3c0-f2c08383c668"},{"version":"CommandV1","origId":1137724266867222,"guid":"d22330bb-af9c-4357-9506-96fd35cb9904","subtype":"command","commandType":"auto","position":11.0,"command":"employees.display()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[100,"Steven","King","09/01/2009","AD_PRES",24000,null,90],[101,"Neena","Kochhar","12/07/2011","AD_VP",17000,100,90],[102,"Lex","De Haan","03/31/2015","AD_VP",17000,100,90],[103,"Alexander","Hunold","03/20/2012","IT_PROG",9000,102,60],[104,"Bruce","Ernst","08/05/2013","IT_PROG",6000,103,60],[105,"David","Austin","09/10/2019","IT_PROG",4800,103,60],[106,"Valli","Pataballa","04/22/2020","IT_PROG",4800,103,60],[107,"Diana","Lorentz","04/24/2021","IT_PROG",4200,103,60],[108,"Nancy","Greenberg","11/01/2016","FI_MGR",12000,101,100],[109,"Daniel","Faviet","10/31/2016","FI_ACCOUNT",9000,108,100],[110,"John","Chen","12/14/2019","FI_ACCOUNT",8200,108,100],[111,"Ismael","Sciarra","12/16/2019","FI_ACCOUNT",7700,108,100],[112,"Jose Manuel","Urman","05/22/2020","FI_ACCOUNT",7800,108,100],[113,"Luis","Popp","02/21/2022","FI_ACCOUNT",6900,108,100],[114,"Den","Raphaely","02/21/2017","PU_MAN",11000,100,30],[115,"Alexander","Khoo","08/02/2017","PU_CLERK",3100,114,30],[116,"Shelli","Baida","03/10/2020","PU_CLERK",2900,114,30],[117,"Sigal","Tobias","10/09/2019","PU_CLERK",2800,114,30],[118,"Guy","Himuro","01/30/2021","PU_CLERK",2600,114,30],[119,"Karen","Colmenares","10/25/2021","PU_CLERK",2500,114,30],[120,"Matthew","Weiss","10/03/2018","ST_MAN",8000,100,50],[121,"Adam","Fripp","06/26/2019","ST_MAN",8200,100,50],[122,"Payam","Kaufling","07/16/2017","ST_MAN",7900,100,50],[123,"Shanta","Vollman","12/26/2019","ST_MAN",6500,100,50],[124,"Kevin","Mourgos","01/31/2022","ST_MAN",5800,100,50],[125,"Julia","Nayer","10/01/2019","ST_CLERK",3200,120,50],[126,"Irene","Mikkilineni","12/13/2020","ST_CLERK",2700,120,50],[127,"James","Landry","03/31/2021","ST_CLERK",2400,120,50],[128,"Steven","Markle","05/24/2022","ST_CLERK",2200,120,50],[129,"Laura","Bissot","11/05/2019","ST_CLERK",3300,121,50],[130,"Mozhe","Atkinson","01/15/2020","ST_CLERK",2800,121,50],[131,"James","Marlow","05/04/2019","ST_CLERK",2500,121,50],[132,"TJ","Olson","06/25/2021","ST_CLERK",2100,121,50],[133,"Jason","Mallin","08/30/2018","ST_CLERK",3300,122,50],[134,"Michael","Rogers","11/10/2020","ST_CLERK",2900,122,50],[135,"Ki","Gee","02/26/2022","ST_CLERK",2400,122,50],[136,"Hazel","Philtanker","04/23/2022","ST_CLERK",2200,122,50],[137,"Renske","Ladwig","09/28/2017","ST_CLERK",3600,123,50],[138,"Stephen","Stiles","01/11/2020","ST_CLERK",3200,123,50],[139,"John","Seo","04/29/2020","ST_CLERK",2700,123,50],[140,"Joshua","Patel","06/21/2020","ST_CLERK",2500,123,50],[141,"Trenna","Rajs","01/01/2018","ST_CLERK",3500,124,50],[142,"Curtis","Davies","04/16/2019","ST_CLERK",3100,124,50],[143,"Randall","Matos","05/30/2020","ST_CLERK",2600,124,50],[144,"Peter","Vargas","09/23/2020","ST_CLERK",2500,124,50],[145,"John","Russell","12/17/2018","SA_MAN",14000,100,80],[146,"Karen","Partners","03/23/2019","SA_MAN",13500,100,80],[147,"Alberto","Errazuriz","05/26/2019","SA_MAN",12000,100,80],[148,"Gerald","Cambrault","12/30/2021","SA_MAN",11000,100,80],[149,"Eleni","Zlotkey","04/15/2022","SA_MAN",10500,100,80],[150,"Peter","Tucker","04/17/2019","SA_REP",10000,145,80],[151,"David","Bernstein","06/09/2019","SA_REP",9500,145,80],[152,"Peter","Hall","11/05/2019","SA_REP",9000,145,80],[153,"Christopher","Olsen","06/14/2020","SA_REP",8000,145,80],[154,"Nanette","Cambrault","02/23/2021","SA_REP",7500,145,80],[155,"Oliver","Tuvault","02/07/2022","SA_REP",7000,145,80],[156,"Janette","King","04/16/2018","SA_REP",10000,146,80],[157,"Patrick","Sully","05/20/2018","SA_REP",9500,146,80],[158,"Allan","McEwen","10/17/2018","SA_REP",9000,146,80],[159,"Lindsey","Smith","05/26/2019","SA_REP",8000,146,80],[160,"Louise","Doran","03/01/2020","SA_REP",7500,146,80],[161,"Sarath","Sewall","01/18/2021","SA_REP",7000,146,80],[162,"Clara","Vishney","01/27/2020","SA_REP",10500,147,80],[163,"Danielle","Greene","06/03/2021","SA_REP",9500,147,80],[164,"Mattea","Marvins","04/10/2022","SA_REP",7200,147,80],[165,"David","Lee","05/10/2022","SA_REP",6800,147,80],[166,"Sundar","Ande","06/09/2022","SA_REP",6400,147,80],[167,"Amit","Banda","07/07/2022","SA_REP",6200,147,80],[168,"Lisa","Ozer","05/27/2019","SA_REP",11500,148,80],[169,"Harrison","Bloom","06/07/2020","SA_REP",10000,148,80],[170,"Tayler","Fox","04/10/2020","SA_REP",9600,148,80],[171,"William","Smith","05/10/2021","SA_REP",7400,148,80],[172,"Elizabeth","Bates","06/08/2021","SA_REP",7300,148,80],[173,"Sundita","Kumar","07/07/2022","SA_REP",6100,148,80],[174,"Ellen","Abel","07/27/2018","SA_REP",11000,149,80],[175,"Alyssa","Hutton","06/04/2019","SA_REP",8800,149,80],[176,"Jonathon","Taylor","06/08/2020","SA_REP",8600,149,80],[177,"Jack","Livingston","07/08/2020","SA_REP",8400,149,80],[178,"Kimberely","Grant","08/08/2021","SA_REP",7000,149,null],[179,"Charles","Johnson","03/21/2022","SA_REP",6200,149,80],[180,"Winston","Taylor","04/10/2020","SH_CLERK",3200,120,50],[181,"Jean","Fleaur","05/10/2020","SH_CLERK",3100,120,50],[182,"Martha","Sullivan","09/05/2021","SH_CLERK",2500,120,50],[183,"Girard","Geoni","04/20/2022","SH_CLERK",2800,120,50],[184,"Nandita","Sarchand","04/13/2018","SH_CLERK",4200,121,50],[185,"Alexis","Bull","05/08/2019","SH_CLERK",4100,121,50],[186,"Julia","Dellinger","09/08/2020","SH_CLERK",3400,121,50],[187,"Anthony","Cabrio","04/24/2021","SH_CLERK",3000,121,50],[188,"Kelly","Chung","08/30/2019","SH_CLERK",3800,122,50],[189,"Jennifer","Dilly","10/29/2019","SH_CLERK",3600,122,50],[190,"Timothy","Gates","09/25/2020","SH_CLERK",2900,122,50],[191,"Randall","Perkins","03/05/2022","SH_CLERK",2500,122,50],[192,"Sarah","Bell","04/21/2018","SH_CLERK",4000,123,50],[193,"Britney","Everett","05/19/2019","SH_CLERK",3900,123,50],[194,"Samuel","McCain","09/15/2020","SH_CLERK",3200,123,50],[195,"Vance","Jones","06/01/2021","SH_CLERK",2800,123,50],[196,"Alana","Walsh","07/09/2020","SH_CLERK",3100,124,50],[197,"Kevin","Feeney","08/07/2020","SH_CLERK",3000,124,50],[198,"Donald","OConnell","09/05/2021","SH_CLERK",2600,124,50],[199,"Douglas","Grant","03/30/2022","SH_CLERK",2600,124,50],[200,"Jennifer","Whalen","12/02/2009","AD_ASST",4400,101,10],[201,"Michael","Hartstein","05/04/2018","MK_MAN",13000,100,20],[202,"Pat","Fay","11/02/2019","MK_REP",6000,201,20],[203,"Susan","Mavris","08/22/2016","HR_REP",6500,101,40],[204,"Hermann","Baer","08/22/2016","PR_REP",10000,101,70],[205,"Shelley","Higgins","08/22/2016","AC_MGR",12000,101,110],[206,"William","Gietz","08/22/2016","AC_ACCOUNT",8300,205,110]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"EMPLOYEE_ID","type":"\"integer\"","metadata":"{}"},{"name":"FIRST_NAME","type":"\"string\"","metadata":"{}"},{"name":"LAST_NAME","type":"\"string\"","metadata":"{}"},{"name":"HIRE_DATE","type":"\"string\"","metadata":"{}"},{"name":"JOB_ID","type":"\"string\"","metadata":"{}"},{"name":"SALARY","type":"\"integer\"","metadata":"{}"},{"name":"MANAGER_ID","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_ID","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128465138,"submitTime":1667128465115,"finishTime":1667128465394,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",107]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"87fd241f-ed36-49b5-9e95-92b95fc18d4f"},{"version":"CommandV1","origId":1137724266867223,"guid":"2f2b9961-bbf3-453f-85b2-8872271b6ed6","subtype":"command","commandType":"auto","position":11.5,"command":"# Changing the data type of hire_date from string to data via the to_date function\n# https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.to_date.html?highlight=to_date#pyspark.sql.functions.to_date\n# https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html\nfrom pyspark.sql.functions import to_date\nemployees = employees.select(\n    \"EMPLOYEE_ID\",\n    \"FIRST_NAME\",\n    \"LAST_NAME\",\n    to_date(employees[\"HIRE_DATE\"], \"MM/dd/yyyy\").alias('HIRE_DATE'),\n    \"JOB_ID\",\n    \"SALARY\",\n    \"MANAGER_ID\",\n    \"DEPARTMENT_ID\"\n)","commandVersion":91,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employees","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"EMPLOYEE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"FIRST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"LAST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"HIRE_DATE","nullable":true,"type":"date"},{"metadata":{},"name":"JOB_ID","nullable":true,"type":"string"},{"metadata":{},"name":"SALARY","nullable":true,"type":"integer"},{"metadata":{},"name":"MANAGER_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_ID","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128490668,"submitTime":1667128490644,"finishTime":1667128490774,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b92c7cd6-43d8-4f05-b2d0-bb53676d2b85"},{"version":"CommandV1","origId":1137724266867224,"guid":"f544fe1c-ab16-4178-9247-6a79d3783262","subtype":"command","commandType":"auto","position":11.75,"command":"employees.display()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[100,"Steven","King","2009-09-01","AD_PRES",24000,null,90],[101,"Neena","Kochhar","2011-12-07","AD_VP",17000,100,90],[102,"Lex","De Haan","2015-03-31","AD_VP",17000,100,90],[103,"Alexander","Hunold","2012-03-20","IT_PROG",9000,102,60],[104,"Bruce","Ernst","2013-08-05","IT_PROG",6000,103,60],[105,"David","Austin","2019-09-10","IT_PROG",4800,103,60],[106,"Valli","Pataballa","2020-04-22","IT_PROG",4800,103,60],[107,"Diana","Lorentz","2021-04-24","IT_PROG",4200,103,60],[108,"Nancy","Greenberg","2016-11-01","FI_MGR",12000,101,100],[109,"Daniel","Faviet","2016-10-31","FI_ACCOUNT",9000,108,100],[110,"John","Chen","2019-12-14","FI_ACCOUNT",8200,108,100],[111,"Ismael","Sciarra","2019-12-16","FI_ACCOUNT",7700,108,100],[112,"Jose Manuel","Urman","2020-05-22","FI_ACCOUNT",7800,108,100],[113,"Luis","Popp","2022-02-21","FI_ACCOUNT",6900,108,100],[114,"Den","Raphaely","2017-02-21","PU_MAN",11000,100,30],[115,"Alexander","Khoo","2017-08-02","PU_CLERK",3100,114,30],[116,"Shelli","Baida","2020-03-10","PU_CLERK",2900,114,30],[117,"Sigal","Tobias","2019-10-09","PU_CLERK",2800,114,30],[118,"Guy","Himuro","2021-01-30","PU_CLERK",2600,114,30],[119,"Karen","Colmenares","2021-10-25","PU_CLERK",2500,114,30],[120,"Matthew","Weiss","2018-10-03","ST_MAN",8000,100,50],[121,"Adam","Fripp","2019-06-26","ST_MAN",8200,100,50],[122,"Payam","Kaufling","2017-07-16","ST_MAN",7900,100,50],[123,"Shanta","Vollman","2019-12-26","ST_MAN",6500,100,50],[124,"Kevin","Mourgos","2022-01-31","ST_MAN",5800,100,50],[125,"Julia","Nayer","2019-10-01","ST_CLERK",3200,120,50],[126,"Irene","Mikkilineni","2020-12-13","ST_CLERK",2700,120,50],[127,"James","Landry","2021-03-31","ST_CLERK",2400,120,50],[128,"Steven","Markle","2022-05-24","ST_CLERK",2200,120,50],[129,"Laura","Bissot","2019-11-05","ST_CLERK",3300,121,50],[130,"Mozhe","Atkinson","2020-01-15","ST_CLERK",2800,121,50],[131,"James","Marlow","2019-05-04","ST_CLERK",2500,121,50],[132,"TJ","Olson","2021-06-25","ST_CLERK",2100,121,50],[133,"Jason","Mallin","2018-08-30","ST_CLERK",3300,122,50],[134,"Michael","Rogers","2020-11-10","ST_CLERK",2900,122,50],[135,"Ki","Gee","2022-02-26","ST_CLERK",2400,122,50],[136,"Hazel","Philtanker","2022-04-23","ST_CLERK",2200,122,50],[137,"Renske","Ladwig","2017-09-28","ST_CLERK",3600,123,50],[138,"Stephen","Stiles","2020-01-11","ST_CLERK",3200,123,50],[139,"John","Seo","2020-04-29","ST_CLERK",2700,123,50],[140,"Joshua","Patel","2020-06-21","ST_CLERK",2500,123,50],[141,"Trenna","Rajs","2018-01-01","ST_CLERK",3500,124,50],[142,"Curtis","Davies","2019-04-16","ST_CLERK",3100,124,50],[143,"Randall","Matos","2020-05-30","ST_CLERK",2600,124,50],[144,"Peter","Vargas","2020-09-23","ST_CLERK",2500,124,50],[145,"John","Russell","2018-12-17","SA_MAN",14000,100,80],[146,"Karen","Partners","2019-03-23","SA_MAN",13500,100,80],[147,"Alberto","Errazuriz","2019-05-26","SA_MAN",12000,100,80],[148,"Gerald","Cambrault","2021-12-30","SA_MAN",11000,100,80],[149,"Eleni","Zlotkey","2022-04-15","SA_MAN",10500,100,80],[150,"Peter","Tucker","2019-04-17","SA_REP",10000,145,80],[151,"David","Bernstein","2019-06-09","SA_REP",9500,145,80],[152,"Peter","Hall","2019-11-05","SA_REP",9000,145,80],[153,"Christopher","Olsen","2020-06-14","SA_REP",8000,145,80],[154,"Nanette","Cambrault","2021-02-23","SA_REP",7500,145,80],[155,"Oliver","Tuvault","2022-02-07","SA_REP",7000,145,80],[156,"Janette","King","2018-04-16","SA_REP",10000,146,80],[157,"Patrick","Sully","2018-05-20","SA_REP",9500,146,80],[158,"Allan","McEwen","2018-10-17","SA_REP",9000,146,80],[159,"Lindsey","Smith","2019-05-26","SA_REP",8000,146,80],[160,"Louise","Doran","2020-03-01","SA_REP",7500,146,80],[161,"Sarath","Sewall","2021-01-18","SA_REP",7000,146,80],[162,"Clara","Vishney","2020-01-27","SA_REP",10500,147,80],[163,"Danielle","Greene","2021-06-03","SA_REP",9500,147,80],[164,"Mattea","Marvins","2022-04-10","SA_REP",7200,147,80],[165,"David","Lee","2022-05-10","SA_REP",6800,147,80],[166,"Sundar","Ande","2022-06-09","SA_REP",6400,147,80],[167,"Amit","Banda","2022-07-07","SA_REP",6200,147,80],[168,"Lisa","Ozer","2019-05-27","SA_REP",11500,148,80],[169,"Harrison","Bloom","2020-06-07","SA_REP",10000,148,80],[170,"Tayler","Fox","2020-04-10","SA_REP",9600,148,80],[171,"William","Smith","2021-05-10","SA_REP",7400,148,80],[172,"Elizabeth","Bates","2021-06-08","SA_REP",7300,148,80],[173,"Sundita","Kumar","2022-07-07","SA_REP",6100,148,80],[174,"Ellen","Abel","2018-07-27","SA_REP",11000,149,80],[175,"Alyssa","Hutton","2019-06-04","SA_REP",8800,149,80],[176,"Jonathon","Taylor","2020-06-08","SA_REP",8600,149,80],[177,"Jack","Livingston","2020-07-08","SA_REP",8400,149,80],[178,"Kimberely","Grant","2021-08-08","SA_REP",7000,149,null],[179,"Charles","Johnson","2022-03-21","SA_REP",6200,149,80],[180,"Winston","Taylor","2020-04-10","SH_CLERK",3200,120,50],[181,"Jean","Fleaur","2020-05-10","SH_CLERK",3100,120,50],[182,"Martha","Sullivan","2021-09-05","SH_CLERK",2500,120,50],[183,"Girard","Geoni","2022-04-20","SH_CLERK",2800,120,50],[184,"Nandita","Sarchand","2018-04-13","SH_CLERK",4200,121,50],[185,"Alexis","Bull","2019-05-08","SH_CLERK",4100,121,50],[186,"Julia","Dellinger","2020-09-08","SH_CLERK",3400,121,50],[187,"Anthony","Cabrio","2021-04-24","SH_CLERK",3000,121,50],[188,"Kelly","Chung","2019-08-30","SH_CLERK",3800,122,50],[189,"Jennifer","Dilly","2019-10-29","SH_CLERK",3600,122,50],[190,"Timothy","Gates","2020-09-25","SH_CLERK",2900,122,50],[191,"Randall","Perkins","2022-03-05","SH_CLERK",2500,122,50],[192,"Sarah","Bell","2018-04-21","SH_CLERK",4000,123,50],[193,"Britney","Everett","2019-05-19","SH_CLERK",3900,123,50],[194,"Samuel","McCain","2020-09-15","SH_CLERK",3200,123,50],[195,"Vance","Jones","2021-06-01","SH_CLERK",2800,123,50],[196,"Alana","Walsh","2020-07-09","SH_CLERK",3100,124,50],[197,"Kevin","Feeney","2020-08-07","SH_CLERK",3000,124,50],[198,"Donald","OConnell","2021-09-05","SH_CLERK",2600,124,50],[199,"Douglas","Grant","2022-03-30","SH_CLERK",2600,124,50],[200,"Jennifer","Whalen","2009-12-02","AD_ASST",4400,101,10],[201,"Michael","Hartstein","2018-05-04","MK_MAN",13000,100,20],[202,"Pat","Fay","2019-11-02","MK_REP",6000,201,20],[203,"Susan","Mavris","2016-08-22","HR_REP",6500,101,40],[204,"Hermann","Baer","2016-08-22","PR_REP",10000,101,70],[205,"Shelley","Higgins","2016-08-22","AC_MGR",12000,101,110],[206,"William","Gietz","2016-08-22","AC_ACCOUNT",8300,205,110]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"EMPLOYEE_ID","type":"\"integer\"","metadata":"{}"},{"name":"FIRST_NAME","type":"\"string\"","metadata":"{}"},{"name":"LAST_NAME","type":"\"string\"","metadata":"{}"},{"name":"HIRE_DATE","type":"\"date\"","metadata":"{}"},{"name":"JOB_ID","type":"\"string\"","metadata":"{}"},{"name":"SALARY","type":"\"integer\"","metadata":"{}"},{"name":"MANAGER_ID","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_ID","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128493023,"submitTime":1667128493000,"finishTime":1667128493567,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",107]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b1f869c7-f80d-450c-9f80-04f34716b267"},{"version":"CommandV1","origId":1137724266867225,"guid":"457eece3-8356-4984-912f-e890e19a3510","subtype":"command","commandType":"auto","position":12.0,"command":"# Writing dataframe as parquet file to the silver layer\nemployees.write.parquet(\"/mnt/employees/silver/employees\", mode='overwrite')","commandVersion":39,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128510550,"submitTime":1667128510527,"finishTime":1667128513982,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0b915f1e-4261-4461-b508-2777f3146880"},{"version":"CommandV1","origId":1137724266867226,"guid":"c58a17e2-a392-4bcf-9121-9ec533f9f1c2","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n##### Departments","commandVersion":5,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"52bfd08c-8de7-472a-8d81-26ab42bed61e"},{"version":"CommandV1","origId":1137724266867227,"guid":"83c4c797-0c1a-4770-986f-bdafc7971bc3","subtype":"command","commandType":"auto","position":14.0,"command":"# Reading in the departments csv file from the bronze layer\ndept_path = '/mnt/employees/bronze/departments.csv'\n \n\ndept_schema = StructType([\n                    StructField(\"DEPARTMENT_ID\", IntegerType(), False),\n                    StructField(\"DEPARTMENT_NAME\", StringType(), False),\n                    StructField(\"MANAGER_ID\", IntegerType(), True),\n                    StructField(\"LOCATION_ID\", IntegerType(), False)\n                    ]\n                    )\n \ndept=spark.read.csv(path=dept_path, header=True, schema=dept_schema)","commandVersion":25,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"dept","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"DEPARTMENT_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"MANAGER_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"LOCATION_ID","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128535701,"submitTime":1667128535676,"finishTime":1667128535983,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9ca6934c-fcd2-492d-b2da-e21858321b8d"},{"version":"CommandV1","origId":1137724266867228,"guid":"23680841-1405-41f9-a591-53cd8b4d7de2","subtype":"command","commandType":"auto","position":15.0,"command":"dept.display()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[10,"Administration",200,1700],[20,"Marketing",201,1800],[30,"Purchasing",114,1700],[40,"Human Resources",203,2400],[50,"Shipping",121,1500],[60,"IT",103,1400],[70,"Public Relations",204,2700],[80,"Sales",145,2500],[90,"Executive",100,1700],[100,"Finance",108,1700],[110,"Accounting",205,1700],[120,"Treasury",null,1700],[130,"Corporate Tax",null,1700],[140,"Control And Credit",null,1700],[150,"Shareholder Services",null,1700],[160,"Benefits",null,1700],[170,"Manufacturing",null,1700],[180,"Construction",null,1700],[190,"Contracting",null,1700],[200,"Operations",null,1700],[210,"IT Support",null,1700],[220,"NOC",null,1700],[230,"IT Helpdesk",null,1700],[240,"Government Sales",null,1700],[250,"Retail Sales",null,1700],[260,"Recruiting",null,1700],[270,"Payroll",null,1700]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEPARTMENT_ID","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_NAME","type":"\"string\"","metadata":"{}"},{"name":"MANAGER_ID","type":"\"integer\"","metadata":"{}"},{"name":"LOCATION_ID","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128537173,"submitTime":1667128537149,"finishTime":1667128537320,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7ad00059-2c6c-4f22-b1eb-baadd497d613"},{"version":"CommandV1","origId":1137724266867229,"guid":"5577adfd-dad7-4151-9404-5d5b0316fba1","subtype":"command","commandType":"auto","position":16.0,"command":"# Dropping unnecessary columns\ndept = dept.drop(\"MANAGER_ID\", \"LOCATION_ID\")","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"dept","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"DEPARTMENT_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_NAME","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128540375,"submitTime":1667128540352,"finishTime":1667128540400,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"60c93c48-9611-45ca-8f7b-ef9207334765"},{"version":"CommandV1","origId":1137724266867230,"guid":"9ed6b036-091d-45a5-a19f-ec5afec1acf7","subtype":"command","commandType":"auto","position":17.0,"command":"# Writing dataframe as parquet file to the silver layer\ndept.write.parquet(\"/mnt/employees/silver/departments\", mode='overwrite')","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128554003,"submitTime":1667128553968,"finishTime":1667128554837,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"db33ea7d-3964-453e-b508-47301c8e6e80"},{"version":"CommandV1","origId":1137724266867231,"guid":"b396dc07-02ef-474b-8d46-fe79409476b9","subtype":"command","commandType":"auto","position":18.0,"command":"%md\n##### Countries","commandVersion":5,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e988af14-83e8-46c8-909c-6421d66eb1df"},{"version":"CommandV1","origId":1137724266867232,"guid":"3f297e30-09a9-4d2c-a042-0d4bb7d5c5ae","subtype":"command","commandType":"auto","position":19.0,"command":"# Reading in the countries csv file from the bronze layer\ncountries_path = '/mnt/employees/bronze/countries.csv'\n \n\ncountries_schema = StructType([\n                    StructField(\"COUNTRY_ID\", StringType(), False),\n                    StructField(\"COUNTRY_NAME\", StringType(), False)\n                    ]\n                    )\n \ncountries=spark.read.csv(path=countries_path, header=True, schema=countries_schema)","commandVersion":20,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"countries","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"COUNTRY_ID","nullable":true,"type":"string"},{"metadata":{},"name":"COUNTRY_NAME","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128611068,"submitTime":1667128611031,"finishTime":1667128611345,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f42892e4-ab37-42e7-9ac1-2e7233bd8428"},{"version":"CommandV1","origId":1137724266867233,"guid":"f82c2d43-c6e0-45b1-89d2-a5ddf901f740","subtype":"command","commandType":"auto","position":20.0,"command":"countries.display()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["AR","Argentina"],["AU","Australia"],["BE","Belgium"],["BR","Brazil"],["CA","Canada"],["CH","Switzerland"],["CN","China"],["DE","Germany"],["DK","Denmark"],["EG","Egypt"],["FR","France"],["HK","HongKong"],["IL","Israel"],["IN","India"],["IT","Italy"],["JP","Japan"],["KW","Kuwait"],["MX","Mexico"],["NG","Nigeria"],["NL","Netherlands"],["SG","Singapore"],["UK","United Kingdom"],["US","United States of America"],["ZM","Zambia"],["ZW","Zimbabwe"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"COUNTRY_ID","type":"\"string\"","metadata":"{}"},{"name":"COUNTRY_NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128614258,"submitTime":1667128614236,"finishTime":1667128614423,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",25]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"340fff0b-a82a-4f76-ae98-773b1dd15c82"},{"version":"CommandV1","origId":1137724266867234,"guid":"6525ca70-a245-4da7-bbbb-237d40734617","subtype":"command","commandType":"auto","position":21.0,"command":"# Writing dataframe as parquet file to the silver layer\ncountries.write.parquet(\"/mnt/employees/silver/countries\", mode='overwrite')","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128635055,"submitTime":1667128635031,"finishTime":1667128636006,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bfa4c7c4-bc1f-424f-95a7-7c61f8befa27"},{"version":"CommandV1","origId":1137724266867235,"guid":"47103b83-6426-4fb8-aa06-6a32d636bbac","subtype":"command","commandType":"auto","position":22.0,"command":"%md\n#### 3. Adding parquet files to the gold folder of the employees container","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"70598b56-4036-4552-b365-b78bd2348070"},{"version":"CommandV1","origId":1137724266867236,"guid":"d949cbad-b951-410d-99e2-d4b97fec5041","subtype":"command","commandType":"auto","position":22.5,"command":"%md\n##### Employees","commandVersion":7,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3219bba2-31bc-4151-8824-1bcfac4a9264"},{"version":"CommandV1","origId":1137724266867237,"guid":"4ab5d117-f032-4799-8b3f-1f2fe7742ad6","subtype":"command","commandType":"auto","position":23.0,"command":"employees = spark.read.parquet(\"/mnt/employees/silver/employees\")","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employees","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"EMPLOYEE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"FIRST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"LAST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"HIRE_DATE","nullable":true,"type":"date"},{"metadata":{},"name":"JOB_ID","nullable":true,"type":"string"},{"metadata":{},"name":"SALARY","nullable":true,"type":"integer"},{"metadata":{},"name":"MANAGER_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_ID","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128670518,"submitTime":1667128670496,"finishTime":1667128670986,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"04f29601-eab0-4cad-a11f-ba581cb29644"},{"version":"CommandV1","origId":1137724266867238,"guid":"2d07c19b-50fa-4362-8c78-9c6aa43c4069","subtype":"command","commandType":"auto","position":24.0,"command":"employees.display()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[100,"Steven","King","2009-09-01","AD_PRES",24000,null,90],[101,"Neena","Kochhar","2011-12-07","AD_VP",17000,100,90],[102,"Lex","De Haan","2015-03-31","AD_VP",17000,100,90],[103,"Alexander","Hunold","2012-03-20","IT_PROG",9000,102,60],[104,"Bruce","Ernst","2013-08-05","IT_PROG",6000,103,60],[105,"David","Austin","2019-09-10","IT_PROG",4800,103,60],[106,"Valli","Pataballa","2020-04-22","IT_PROG",4800,103,60],[107,"Diana","Lorentz","2021-04-24","IT_PROG",4200,103,60],[108,"Nancy","Greenberg","2016-11-01","FI_MGR",12000,101,100],[109,"Daniel","Faviet","2016-10-31","FI_ACCOUNT",9000,108,100],[110,"John","Chen","2019-12-14","FI_ACCOUNT",8200,108,100],[111,"Ismael","Sciarra","2019-12-16","FI_ACCOUNT",7700,108,100],[112,"Jose Manuel","Urman","2020-05-22","FI_ACCOUNT",7800,108,100],[113,"Luis","Popp","2022-02-21","FI_ACCOUNT",6900,108,100],[114,"Den","Raphaely","2017-02-21","PU_MAN",11000,100,30],[115,"Alexander","Khoo","2017-08-02","PU_CLERK",3100,114,30],[116,"Shelli","Baida","2020-03-10","PU_CLERK",2900,114,30],[117,"Sigal","Tobias","2019-10-09","PU_CLERK",2800,114,30],[118,"Guy","Himuro","2021-01-30","PU_CLERK",2600,114,30],[119,"Karen","Colmenares","2021-10-25","PU_CLERK",2500,114,30],[120,"Matthew","Weiss","2018-10-03","ST_MAN",8000,100,50],[121,"Adam","Fripp","2019-06-26","ST_MAN",8200,100,50],[122,"Payam","Kaufling","2017-07-16","ST_MAN",7900,100,50],[123,"Shanta","Vollman","2019-12-26","ST_MAN",6500,100,50],[124,"Kevin","Mourgos","2022-01-31","ST_MAN",5800,100,50],[125,"Julia","Nayer","2019-10-01","ST_CLERK",3200,120,50],[126,"Irene","Mikkilineni","2020-12-13","ST_CLERK",2700,120,50],[127,"James","Landry","2021-03-31","ST_CLERK",2400,120,50],[128,"Steven","Markle","2022-05-24","ST_CLERK",2200,120,50],[129,"Laura","Bissot","2019-11-05","ST_CLERK",3300,121,50],[130,"Mozhe","Atkinson","2020-01-15","ST_CLERK",2800,121,50],[131,"James","Marlow","2019-05-04","ST_CLERK",2500,121,50],[132,"TJ","Olson","2021-06-25","ST_CLERK",2100,121,50],[133,"Jason","Mallin","2018-08-30","ST_CLERK",3300,122,50],[134,"Michael","Rogers","2020-11-10","ST_CLERK",2900,122,50],[135,"Ki","Gee","2022-02-26","ST_CLERK",2400,122,50],[136,"Hazel","Philtanker","2022-04-23","ST_CLERK",2200,122,50],[137,"Renske","Ladwig","2017-09-28","ST_CLERK",3600,123,50],[138,"Stephen","Stiles","2020-01-11","ST_CLERK",3200,123,50],[139,"John","Seo","2020-04-29","ST_CLERK",2700,123,50],[140,"Joshua","Patel","2020-06-21","ST_CLERK",2500,123,50],[141,"Trenna","Rajs","2018-01-01","ST_CLERK",3500,124,50],[142,"Curtis","Davies","2019-04-16","ST_CLERK",3100,124,50],[143,"Randall","Matos","2020-05-30","ST_CLERK",2600,124,50],[144,"Peter","Vargas","2020-09-23","ST_CLERK",2500,124,50],[145,"John","Russell","2018-12-17","SA_MAN",14000,100,80],[146,"Karen","Partners","2019-03-23","SA_MAN",13500,100,80],[147,"Alberto","Errazuriz","2019-05-26","SA_MAN",12000,100,80],[148,"Gerald","Cambrault","2021-12-30","SA_MAN",11000,100,80],[149,"Eleni","Zlotkey","2022-04-15","SA_MAN",10500,100,80],[150,"Peter","Tucker","2019-04-17","SA_REP",10000,145,80],[151,"David","Bernstein","2019-06-09","SA_REP",9500,145,80],[152,"Peter","Hall","2019-11-05","SA_REP",9000,145,80],[153,"Christopher","Olsen","2020-06-14","SA_REP",8000,145,80],[154,"Nanette","Cambrault","2021-02-23","SA_REP",7500,145,80],[155,"Oliver","Tuvault","2022-02-07","SA_REP",7000,145,80],[156,"Janette","King","2018-04-16","SA_REP",10000,146,80],[157,"Patrick","Sully","2018-05-20","SA_REP",9500,146,80],[158,"Allan","McEwen","2018-10-17","SA_REP",9000,146,80],[159,"Lindsey","Smith","2019-05-26","SA_REP",8000,146,80],[160,"Louise","Doran","2020-03-01","SA_REP",7500,146,80],[161,"Sarath","Sewall","2021-01-18","SA_REP",7000,146,80],[162,"Clara","Vishney","2020-01-27","SA_REP",10500,147,80],[163,"Danielle","Greene","2021-06-03","SA_REP",9500,147,80],[164,"Mattea","Marvins","2022-04-10","SA_REP",7200,147,80],[165,"David","Lee","2022-05-10","SA_REP",6800,147,80],[166,"Sundar","Ande","2022-06-09","SA_REP",6400,147,80],[167,"Amit","Banda","2022-07-07","SA_REP",6200,147,80],[168,"Lisa","Ozer","2019-05-27","SA_REP",11500,148,80],[169,"Harrison","Bloom","2020-06-07","SA_REP",10000,148,80],[170,"Tayler","Fox","2020-04-10","SA_REP",9600,148,80],[171,"William","Smith","2021-05-10","SA_REP",7400,148,80],[172,"Elizabeth","Bates","2021-06-08","SA_REP",7300,148,80],[173,"Sundita","Kumar","2022-07-07","SA_REP",6100,148,80],[174,"Ellen","Abel","2018-07-27","SA_REP",11000,149,80],[175,"Alyssa","Hutton","2019-06-04","SA_REP",8800,149,80],[176,"Jonathon","Taylor","2020-06-08","SA_REP",8600,149,80],[177,"Jack","Livingston","2020-07-08","SA_REP",8400,149,80],[178,"Kimberely","Grant","2021-08-08","SA_REP",7000,149,null],[179,"Charles","Johnson","2022-03-21","SA_REP",6200,149,80],[180,"Winston","Taylor","2020-04-10","SH_CLERK",3200,120,50],[181,"Jean","Fleaur","2020-05-10","SH_CLERK",3100,120,50],[182,"Martha","Sullivan","2021-09-05","SH_CLERK",2500,120,50],[183,"Girard","Geoni","2022-04-20","SH_CLERK",2800,120,50],[184,"Nandita","Sarchand","2018-04-13","SH_CLERK",4200,121,50],[185,"Alexis","Bull","2019-05-08","SH_CLERK",4100,121,50],[186,"Julia","Dellinger","2020-09-08","SH_CLERK",3400,121,50],[187,"Anthony","Cabrio","2021-04-24","SH_CLERK",3000,121,50],[188,"Kelly","Chung","2019-08-30","SH_CLERK",3800,122,50],[189,"Jennifer","Dilly","2019-10-29","SH_CLERK",3600,122,50],[190,"Timothy","Gates","2020-09-25","SH_CLERK",2900,122,50],[191,"Randall","Perkins","2022-03-05","SH_CLERK",2500,122,50],[192,"Sarah","Bell","2018-04-21","SH_CLERK",4000,123,50],[193,"Britney","Everett","2019-05-19","SH_CLERK",3900,123,50],[194,"Samuel","McCain","2020-09-15","SH_CLERK",3200,123,50],[195,"Vance","Jones","2021-06-01","SH_CLERK",2800,123,50],[196,"Alana","Walsh","2020-07-09","SH_CLERK",3100,124,50],[197,"Kevin","Feeney","2020-08-07","SH_CLERK",3000,124,50],[198,"Donald","OConnell","2021-09-05","SH_CLERK",2600,124,50],[199,"Douglas","Grant","2022-03-30","SH_CLERK",2600,124,50],[200,"Jennifer","Whalen","2009-12-02","AD_ASST",4400,101,10],[201,"Michael","Hartstein","2018-05-04","MK_MAN",13000,100,20],[202,"Pat","Fay","2019-11-02","MK_REP",6000,201,20],[203,"Susan","Mavris","2016-08-22","HR_REP",6500,101,40],[204,"Hermann","Baer","2016-08-22","PR_REP",10000,101,70],[205,"Shelley","Higgins","2016-08-22","AC_MGR",12000,101,110],[206,"William","Gietz","2016-08-22","AC_ACCOUNT",8300,205,110]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"EMPLOYEE_ID","type":"\"integer\"","metadata":"{}"},{"name":"FIRST_NAME","type":"\"string\"","metadata":"{}"},{"name":"LAST_NAME","type":"\"string\"","metadata":"{}"},{"name":"HIRE_DATE","type":"\"date\"","metadata":"{}"},{"name":"JOB_ID","type":"\"string\"","metadata":"{}"},{"name":"SALARY","type":"\"integer\"","metadata":"{}"},{"name":"MANAGER_ID","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_ID","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128671983,"submitTime":1667128671955,"finishTime":1667128676319,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",107]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"95055d4f-ab86-4c86-b302-28670de75467"},{"version":"CommandV1","origId":1137724266867239,"guid":"9d981d80-af2e-4a68-87cf-56a4309b4a41","subtype":"command","commandType":"auto","position":25.0,"command":"# create a new column called full_name via the withColumn method and using the concat_ws function\nfrom pyspark.sql.functions import concat_ws\nemployees=employees.withColumn(\"FULL_NAME\", concat_ws(' ', employees['FIRST_NAME'], employees['LAST_NAME']))","commandVersion":68,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employees","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"EMPLOYEE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"FIRST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"LAST_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"HIRE_DATE","nullable":true,"type":"date"},{"metadata":{},"name":"JOB_ID","nullable":true,"type":"string"},{"metadata":{},"name":"SALARY","nullable":true,"type":"integer"},{"metadata":{},"name":"MANAGER_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"FULL_NAME","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128697438,"submitTime":1667128697408,"finishTime":1667128697488,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"392e2a1b-ecb1-43a4-9249-6b331d4bb5a7"},{"version":"CommandV1","origId":1137724266867240,"guid":"b639695f-ce17-43e0-899e-7b4088ae9926","subtype":"command","commandType":"auto","position":26.0,"command":"employees.display()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[100,"Steven","King","2009-09-01","AD_PRES",24000,null,90,"Steven King"],[101,"Neena","Kochhar","2011-12-07","AD_VP",17000,100,90,"Neena Kochhar"],[102,"Lex","De Haan","2015-03-31","AD_VP",17000,100,90,"Lex De Haan"],[103,"Alexander","Hunold","2012-03-20","IT_PROG",9000,102,60,"Alexander Hunold"],[104,"Bruce","Ernst","2013-08-05","IT_PROG",6000,103,60,"Bruce Ernst"],[105,"David","Austin","2019-09-10","IT_PROG",4800,103,60,"David Austin"],[106,"Valli","Pataballa","2020-04-22","IT_PROG",4800,103,60,"Valli Pataballa"],[107,"Diana","Lorentz","2021-04-24","IT_PROG",4200,103,60,"Diana Lorentz"],[108,"Nancy","Greenberg","2016-11-01","FI_MGR",12000,101,100,"Nancy Greenberg"],[109,"Daniel","Faviet","2016-10-31","FI_ACCOUNT",9000,108,100,"Daniel Faviet"],[110,"John","Chen","2019-12-14","FI_ACCOUNT",8200,108,100,"John Chen"],[111,"Ismael","Sciarra","2019-12-16","FI_ACCOUNT",7700,108,100,"Ismael Sciarra"],[112,"Jose Manuel","Urman","2020-05-22","FI_ACCOUNT",7800,108,100,"Jose Manuel Urman"],[113,"Luis","Popp","2022-02-21","FI_ACCOUNT",6900,108,100,"Luis Popp"],[114,"Den","Raphaely","2017-02-21","PU_MAN",11000,100,30,"Den Raphaely"],[115,"Alexander","Khoo","2017-08-02","PU_CLERK",3100,114,30,"Alexander Khoo"],[116,"Shelli","Baida","2020-03-10","PU_CLERK",2900,114,30,"Shelli Baida"],[117,"Sigal","Tobias","2019-10-09","PU_CLERK",2800,114,30,"Sigal Tobias"],[118,"Guy","Himuro","2021-01-30","PU_CLERK",2600,114,30,"Guy Himuro"],[119,"Karen","Colmenares","2021-10-25","PU_CLERK",2500,114,30,"Karen Colmenares"],[120,"Matthew","Weiss","2018-10-03","ST_MAN",8000,100,50,"Matthew Weiss"],[121,"Adam","Fripp","2019-06-26","ST_MAN",8200,100,50,"Adam Fripp"],[122,"Payam","Kaufling","2017-07-16","ST_MAN",7900,100,50,"Payam Kaufling"],[123,"Shanta","Vollman","2019-12-26","ST_MAN",6500,100,50,"Shanta Vollman"],[124,"Kevin","Mourgos","2022-01-31","ST_MAN",5800,100,50,"Kevin Mourgos"],[125,"Julia","Nayer","2019-10-01","ST_CLERK",3200,120,50,"Julia Nayer"],[126,"Irene","Mikkilineni","2020-12-13","ST_CLERK",2700,120,50,"Irene Mikkilineni"],[127,"James","Landry","2021-03-31","ST_CLERK",2400,120,50,"James Landry"],[128,"Steven","Markle","2022-05-24","ST_CLERK",2200,120,50,"Steven Markle"],[129,"Laura","Bissot","2019-11-05","ST_CLERK",3300,121,50,"Laura Bissot"],[130,"Mozhe","Atkinson","2020-01-15","ST_CLERK",2800,121,50,"Mozhe Atkinson"],[131,"James","Marlow","2019-05-04","ST_CLERK",2500,121,50,"James Marlow"],[132,"TJ","Olson","2021-06-25","ST_CLERK",2100,121,50,"TJ Olson"],[133,"Jason","Mallin","2018-08-30","ST_CLERK",3300,122,50,"Jason Mallin"],[134,"Michael","Rogers","2020-11-10","ST_CLERK",2900,122,50,"Michael Rogers"],[135,"Ki","Gee","2022-02-26","ST_CLERK",2400,122,50,"Ki Gee"],[136,"Hazel","Philtanker","2022-04-23","ST_CLERK",2200,122,50,"Hazel Philtanker"],[137,"Renske","Ladwig","2017-09-28","ST_CLERK",3600,123,50,"Renske Ladwig"],[138,"Stephen","Stiles","2020-01-11","ST_CLERK",3200,123,50,"Stephen Stiles"],[139,"John","Seo","2020-04-29","ST_CLERK",2700,123,50,"John Seo"],[140,"Joshua","Patel","2020-06-21","ST_CLERK",2500,123,50,"Joshua Patel"],[141,"Trenna","Rajs","2018-01-01","ST_CLERK",3500,124,50,"Trenna Rajs"],[142,"Curtis","Davies","2019-04-16","ST_CLERK",3100,124,50,"Curtis Davies"],[143,"Randall","Matos","2020-05-30","ST_CLERK",2600,124,50,"Randall Matos"],[144,"Peter","Vargas","2020-09-23","ST_CLERK",2500,124,50,"Peter Vargas"],[145,"John","Russell","2018-12-17","SA_MAN",14000,100,80,"John Russell"],[146,"Karen","Partners","2019-03-23","SA_MAN",13500,100,80,"Karen Partners"],[147,"Alberto","Errazuriz","2019-05-26","SA_MAN",12000,100,80,"Alberto Errazuriz"],[148,"Gerald","Cambrault","2021-12-30","SA_MAN",11000,100,80,"Gerald Cambrault"],[149,"Eleni","Zlotkey","2022-04-15","SA_MAN",10500,100,80,"Eleni Zlotkey"],[150,"Peter","Tucker","2019-04-17","SA_REP",10000,145,80,"Peter Tucker"],[151,"David","Bernstein","2019-06-09","SA_REP",9500,145,80,"David Bernstein"],[152,"Peter","Hall","2019-11-05","SA_REP",9000,145,80,"Peter Hall"],[153,"Christopher","Olsen","2020-06-14","SA_REP",8000,145,80,"Christopher Olsen"],[154,"Nanette","Cambrault","2021-02-23","SA_REP",7500,145,80,"Nanette Cambrault"],[155,"Oliver","Tuvault","2022-02-07","SA_REP",7000,145,80,"Oliver Tuvault"],[156,"Janette","King","2018-04-16","SA_REP",10000,146,80,"Janette King"],[157,"Patrick","Sully","2018-05-20","SA_REP",9500,146,80,"Patrick Sully"],[158,"Allan","McEwen","2018-10-17","SA_REP",9000,146,80,"Allan McEwen"],[159,"Lindsey","Smith","2019-05-26","SA_REP",8000,146,80,"Lindsey Smith"],[160,"Louise","Doran","2020-03-01","SA_REP",7500,146,80,"Louise Doran"],[161,"Sarath","Sewall","2021-01-18","SA_REP",7000,146,80,"Sarath Sewall"],[162,"Clara","Vishney","2020-01-27","SA_REP",10500,147,80,"Clara Vishney"],[163,"Danielle","Greene","2021-06-03","SA_REP",9500,147,80,"Danielle Greene"],[164,"Mattea","Marvins","2022-04-10","SA_REP",7200,147,80,"Mattea Marvins"],[165,"David","Lee","2022-05-10","SA_REP",6800,147,80,"David Lee"],[166,"Sundar","Ande","2022-06-09","SA_REP",6400,147,80,"Sundar Ande"],[167,"Amit","Banda","2022-07-07","SA_REP",6200,147,80,"Amit Banda"],[168,"Lisa","Ozer","2019-05-27","SA_REP",11500,148,80,"Lisa Ozer"],[169,"Harrison","Bloom","2020-06-07","SA_REP",10000,148,80,"Harrison Bloom"],[170,"Tayler","Fox","2020-04-10","SA_REP",9600,148,80,"Tayler Fox"],[171,"William","Smith","2021-05-10","SA_REP",7400,148,80,"William Smith"],[172,"Elizabeth","Bates","2021-06-08","SA_REP",7300,148,80,"Elizabeth Bates"],[173,"Sundita","Kumar","2022-07-07","SA_REP",6100,148,80,"Sundita Kumar"],[174,"Ellen","Abel","2018-07-27","SA_REP",11000,149,80,"Ellen Abel"],[175,"Alyssa","Hutton","2019-06-04","SA_REP",8800,149,80,"Alyssa Hutton"],[176,"Jonathon","Taylor","2020-06-08","SA_REP",8600,149,80,"Jonathon Taylor"],[177,"Jack","Livingston","2020-07-08","SA_REP",8400,149,80,"Jack Livingston"],[178,"Kimberely","Grant","2021-08-08","SA_REP",7000,149,null,"Kimberely Grant"],[179,"Charles","Johnson","2022-03-21","SA_REP",6200,149,80,"Charles Johnson"],[180,"Winston","Taylor","2020-04-10","SH_CLERK",3200,120,50,"Winston Taylor"],[181,"Jean","Fleaur","2020-05-10","SH_CLERK",3100,120,50,"Jean Fleaur"],[182,"Martha","Sullivan","2021-09-05","SH_CLERK",2500,120,50,"Martha Sullivan"],[183,"Girard","Geoni","2022-04-20","SH_CLERK",2800,120,50,"Girard Geoni"],[184,"Nandita","Sarchand","2018-04-13","SH_CLERK",4200,121,50,"Nandita Sarchand"],[185,"Alexis","Bull","2019-05-08","SH_CLERK",4100,121,50,"Alexis Bull"],[186,"Julia","Dellinger","2020-09-08","SH_CLERK",3400,121,50,"Julia Dellinger"],[187,"Anthony","Cabrio","2021-04-24","SH_CLERK",3000,121,50,"Anthony Cabrio"],[188,"Kelly","Chung","2019-08-30","SH_CLERK",3800,122,50,"Kelly Chung"],[189,"Jennifer","Dilly","2019-10-29","SH_CLERK",3600,122,50,"Jennifer Dilly"],[190,"Timothy","Gates","2020-09-25","SH_CLERK",2900,122,50,"Timothy Gates"],[191,"Randall","Perkins","2022-03-05","SH_CLERK",2500,122,50,"Randall Perkins"],[192,"Sarah","Bell","2018-04-21","SH_CLERK",4000,123,50,"Sarah Bell"],[193,"Britney","Everett","2019-05-19","SH_CLERK",3900,123,50,"Britney Everett"],[194,"Samuel","McCain","2020-09-15","SH_CLERK",3200,123,50,"Samuel McCain"],[195,"Vance","Jones","2021-06-01","SH_CLERK",2800,123,50,"Vance Jones"],[196,"Alana","Walsh","2020-07-09","SH_CLERK",3100,124,50,"Alana Walsh"],[197,"Kevin","Feeney","2020-08-07","SH_CLERK",3000,124,50,"Kevin Feeney"],[198,"Donald","OConnell","2021-09-05","SH_CLERK",2600,124,50,"Donald OConnell"],[199,"Douglas","Grant","2022-03-30","SH_CLERK",2600,124,50,"Douglas Grant"],[200,"Jennifer","Whalen","2009-12-02","AD_ASST",4400,101,10,"Jennifer Whalen"],[201,"Michael","Hartstein","2018-05-04","MK_MAN",13000,100,20,"Michael Hartstein"],[202,"Pat","Fay","2019-11-02","MK_REP",6000,201,20,"Pat Fay"],[203,"Susan","Mavris","2016-08-22","HR_REP",6500,101,40,"Susan Mavris"],[204,"Hermann","Baer","2016-08-22","PR_REP",10000,101,70,"Hermann Baer"],[205,"Shelley","Higgins","2016-08-22","AC_MGR",12000,101,110,"Shelley Higgins"],[206,"William","Gietz","2016-08-22","AC_ACCOUNT",8300,205,110,"William Gietz"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"EMPLOYEE_ID","type":"\"integer\"","metadata":"{}"},{"name":"FIRST_NAME","type":"\"string\"","metadata":"{}"},{"name":"LAST_NAME","type":"\"string\"","metadata":"{}"},{"name":"HIRE_DATE","type":"\"date\"","metadata":"{}"},{"name":"JOB_ID","type":"\"string\"","metadata":"{}"},{"name":"SALARY","type":"\"integer\"","metadata":"{}"},{"name":"MANAGER_ID","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_ID","type":"\"integer\"","metadata":"{}"},{"name":"FULL_NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128699290,"submitTime":1667128699268,"finishTime":1667128699606,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",107]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"44835a9f-e415-4cee-8201-894db3848832"},{"version":"CommandV1","origId":1137724266867241,"guid":"9b37cf60-911b-4c7a-829d-a20e9684df6b","subtype":"command","commandType":"auto","position":27.0,"command":"# Dropping unnecessary columns\nemployees = employees.drop(\"FIRST_NAME\", \"LAST_NAME\", \"MANAGER_ID\")","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employees","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"EMPLOYEE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"HIRE_DATE","nullable":true,"type":"date"},{"metadata":{},"name":"JOB_ID","nullable":true,"type":"string"},{"metadata":{},"name":"SALARY","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"FULL_NAME","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128704398,"submitTime":1667128704374,"finishTime":1667128704430,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"16af1f0e-4a4b-46eb-af27-9c6e0e566356"},{"version":"CommandV1","origId":1137724266867242,"guid":"f9342a34-42eb-424a-b3c9-4cca88e4835c","subtype":"command","commandType":"auto","position":28.0,"command":"employees.display()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[100,"2009-09-01","AD_PRES",24000,90,"Steven King"],[101,"2011-12-07","AD_VP",17000,90,"Neena Kochhar"],[102,"2015-03-31","AD_VP",17000,90,"Lex De Haan"],[103,"2012-03-20","IT_PROG",9000,60,"Alexander Hunold"],[104,"2013-08-05","IT_PROG",6000,60,"Bruce Ernst"],[105,"2019-09-10","IT_PROG",4800,60,"David Austin"],[106,"2020-04-22","IT_PROG",4800,60,"Valli Pataballa"],[107,"2021-04-24","IT_PROG",4200,60,"Diana Lorentz"],[108,"2016-11-01","FI_MGR",12000,100,"Nancy Greenberg"],[109,"2016-10-31","FI_ACCOUNT",9000,100,"Daniel Faviet"],[110,"2019-12-14","FI_ACCOUNT",8200,100,"John Chen"],[111,"2019-12-16","FI_ACCOUNT",7700,100,"Ismael Sciarra"],[112,"2020-05-22","FI_ACCOUNT",7800,100,"Jose Manuel Urman"],[113,"2022-02-21","FI_ACCOUNT",6900,100,"Luis Popp"],[114,"2017-02-21","PU_MAN",11000,30,"Den Raphaely"],[115,"2017-08-02","PU_CLERK",3100,30,"Alexander Khoo"],[116,"2020-03-10","PU_CLERK",2900,30,"Shelli Baida"],[117,"2019-10-09","PU_CLERK",2800,30,"Sigal Tobias"],[118,"2021-01-30","PU_CLERK",2600,30,"Guy Himuro"],[119,"2021-10-25","PU_CLERK",2500,30,"Karen Colmenares"],[120,"2018-10-03","ST_MAN",8000,50,"Matthew Weiss"],[121,"2019-06-26","ST_MAN",8200,50,"Adam Fripp"],[122,"2017-07-16","ST_MAN",7900,50,"Payam Kaufling"],[123,"2019-12-26","ST_MAN",6500,50,"Shanta Vollman"],[124,"2022-01-31","ST_MAN",5800,50,"Kevin Mourgos"],[125,"2019-10-01","ST_CLERK",3200,50,"Julia Nayer"],[126,"2020-12-13","ST_CLERK",2700,50,"Irene Mikkilineni"],[127,"2021-03-31","ST_CLERK",2400,50,"James Landry"],[128,"2022-05-24","ST_CLERK",2200,50,"Steven Markle"],[129,"2019-11-05","ST_CLERK",3300,50,"Laura Bissot"],[130,"2020-01-15","ST_CLERK",2800,50,"Mozhe Atkinson"],[131,"2019-05-04","ST_CLERK",2500,50,"James Marlow"],[132,"2021-06-25","ST_CLERK",2100,50,"TJ Olson"],[133,"2018-08-30","ST_CLERK",3300,50,"Jason Mallin"],[134,"2020-11-10","ST_CLERK",2900,50,"Michael Rogers"],[135,"2022-02-26","ST_CLERK",2400,50,"Ki Gee"],[136,"2022-04-23","ST_CLERK",2200,50,"Hazel Philtanker"],[137,"2017-09-28","ST_CLERK",3600,50,"Renske Ladwig"],[138,"2020-01-11","ST_CLERK",3200,50,"Stephen Stiles"],[139,"2020-04-29","ST_CLERK",2700,50,"John Seo"],[140,"2020-06-21","ST_CLERK",2500,50,"Joshua Patel"],[141,"2018-01-01","ST_CLERK",3500,50,"Trenna Rajs"],[142,"2019-04-16","ST_CLERK",3100,50,"Curtis Davies"],[143,"2020-05-30","ST_CLERK",2600,50,"Randall Matos"],[144,"2020-09-23","ST_CLERK",2500,50,"Peter Vargas"],[145,"2018-12-17","SA_MAN",14000,80,"John Russell"],[146,"2019-03-23","SA_MAN",13500,80,"Karen Partners"],[147,"2019-05-26","SA_MAN",12000,80,"Alberto Errazuriz"],[148,"2021-12-30","SA_MAN",11000,80,"Gerald Cambrault"],[149,"2022-04-15","SA_MAN",10500,80,"Eleni Zlotkey"],[150,"2019-04-17","SA_REP",10000,80,"Peter Tucker"],[151,"2019-06-09","SA_REP",9500,80,"David Bernstein"],[152,"2019-11-05","SA_REP",9000,80,"Peter Hall"],[153,"2020-06-14","SA_REP",8000,80,"Christopher Olsen"],[154,"2021-02-23","SA_REP",7500,80,"Nanette Cambrault"],[155,"2022-02-07","SA_REP",7000,80,"Oliver Tuvault"],[156,"2018-04-16","SA_REP",10000,80,"Janette King"],[157,"2018-05-20","SA_REP",9500,80,"Patrick Sully"],[158,"2018-10-17","SA_REP",9000,80,"Allan McEwen"],[159,"2019-05-26","SA_REP",8000,80,"Lindsey Smith"],[160,"2020-03-01","SA_REP",7500,80,"Louise Doran"],[161,"2021-01-18","SA_REP",7000,80,"Sarath Sewall"],[162,"2020-01-27","SA_REP",10500,80,"Clara Vishney"],[163,"2021-06-03","SA_REP",9500,80,"Danielle Greene"],[164,"2022-04-10","SA_REP",7200,80,"Mattea Marvins"],[165,"2022-05-10","SA_REP",6800,80,"David Lee"],[166,"2022-06-09","SA_REP",6400,80,"Sundar Ande"],[167,"2022-07-07","SA_REP",6200,80,"Amit Banda"],[168,"2019-05-27","SA_REP",11500,80,"Lisa Ozer"],[169,"2020-06-07","SA_REP",10000,80,"Harrison Bloom"],[170,"2020-04-10","SA_REP",9600,80,"Tayler Fox"],[171,"2021-05-10","SA_REP",7400,80,"William Smith"],[172,"2021-06-08","SA_REP",7300,80,"Elizabeth Bates"],[173,"2022-07-07","SA_REP",6100,80,"Sundita Kumar"],[174,"2018-07-27","SA_REP",11000,80,"Ellen Abel"],[175,"2019-06-04","SA_REP",8800,80,"Alyssa Hutton"],[176,"2020-06-08","SA_REP",8600,80,"Jonathon Taylor"],[177,"2020-07-08","SA_REP",8400,80,"Jack Livingston"],[178,"2021-08-08","SA_REP",7000,null,"Kimberely Grant"],[179,"2022-03-21","SA_REP",6200,80,"Charles Johnson"],[180,"2020-04-10","SH_CLERK",3200,50,"Winston Taylor"],[181,"2020-05-10","SH_CLERK",3100,50,"Jean Fleaur"],[182,"2021-09-05","SH_CLERK",2500,50,"Martha Sullivan"],[183,"2022-04-20","SH_CLERK",2800,50,"Girard Geoni"],[184,"2018-04-13","SH_CLERK",4200,50,"Nandita Sarchand"],[185,"2019-05-08","SH_CLERK",4100,50,"Alexis Bull"],[186,"2020-09-08","SH_CLERK",3400,50,"Julia Dellinger"],[187,"2021-04-24","SH_CLERK",3000,50,"Anthony Cabrio"],[188,"2019-08-30","SH_CLERK",3800,50,"Kelly Chung"],[189,"2019-10-29","SH_CLERK",3600,50,"Jennifer Dilly"],[190,"2020-09-25","SH_CLERK",2900,50,"Timothy Gates"],[191,"2022-03-05","SH_CLERK",2500,50,"Randall Perkins"],[192,"2018-04-21","SH_CLERK",4000,50,"Sarah Bell"],[193,"2019-05-19","SH_CLERK",3900,50,"Britney Everett"],[194,"2020-09-15","SH_CLERK",3200,50,"Samuel McCain"],[195,"2021-06-01","SH_CLERK",2800,50,"Vance Jones"],[196,"2020-07-09","SH_CLERK",3100,50,"Alana Walsh"],[197,"2020-08-07","SH_CLERK",3000,50,"Kevin Feeney"],[198,"2021-09-05","SH_CLERK",2600,50,"Donald OConnell"],[199,"2022-03-30","SH_CLERK",2600,50,"Douglas Grant"],[200,"2009-12-02","AD_ASST",4400,10,"Jennifer Whalen"],[201,"2018-05-04","MK_MAN",13000,20,"Michael Hartstein"],[202,"2019-11-02","MK_REP",6000,20,"Pat Fay"],[203,"2016-08-22","HR_REP",6500,40,"Susan Mavris"],[204,"2016-08-22","PR_REP",10000,70,"Hermann Baer"],[205,"2016-08-22","AC_MGR",12000,110,"Shelley Higgins"],[206,"2016-08-22","AC_ACCOUNT",8300,110,"William Gietz"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"EMPLOYEE_ID","type":"\"integer\"","metadata":"{}"},{"name":"HIRE_DATE","type":"\"date\"","metadata":"{}"},{"name":"JOB_ID","type":"\"string\"","metadata":"{}"},{"name":"SALARY","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_ID","type":"\"integer\"","metadata":"{}"},{"name":"FULL_NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128705344,"submitTime":1667128705320,"finishTime":1667128705673,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",107]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3c1cfb44-7e0d-48c2-9d82-0776872eb28b"},{"version":"CommandV1","origId":1137724266867243,"guid":"c2125027-f36c-47cd-a66e-2d8b391e1849","subtype":"command","commandType":"auto","position":29.0,"command":"# Reading in the departments parquet file from the silver layer\ndepartments = spark.read.parquet(\"/mnt/employees/silver/departments\")","commandVersion":27,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"departments","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"DEPARTMENT_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_NAME","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128724054,"submitTime":1667128724034,"finishTime":1667128724406,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"03648172-ba62-428b-848b-bdac4b825b90"},{"version":"CommandV1","origId":1137724266867244,"guid":"536d65b0-33c5-47d8-8e46-e9ae9f2abeaf","subtype":"command","commandType":"auto","position":30.0,"command":"departments.display()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[10,"Administration"],[20,"Marketing"],[30,"Purchasing"],[40,"Human Resources"],[50,"Shipping"],[60,"IT"],[70,"Public Relations"],[80,"Sales"],[90,"Executive"],[100,"Finance"],[110,"Accounting"],[120,"Treasury"],[130,"Corporate Tax"],[140,"Control And Credit"],[150,"Shareholder Services"],[160,"Benefits"],[170,"Manufacturing"],[180,"Construction"],[190,"Contracting"],[200,"Operations"],[210,"IT Support"],[220,"NOC"],[230,"IT Helpdesk"],[240,"Government Sales"],[250,"Retail Sales"],[260,"Recruiting"],[270,"Payroll"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"DEPARTMENT_ID","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128725413,"submitTime":1667128725391,"finishTime":1667128725622,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"93f66b95-4146-4335-8f84-288bbe89a3b2"},{"version":"CommandV1","origId":1137724266867245,"guid":"5ead849e-911d-45cd-b614-ce19efeef0cf","subtype":"command","commandType":"auto","position":31.0,"command":"# Joining the employees and departments silver tables to include the relevant fields such as department id, and drop columns that are not required\nemployees = employees.join(departments, employees['department_id']==departments['department_id'], 'left').select(\"EMPLOYEE_ID\", \"FULL_NAME\",\"HIRE_DATE\", \"JOB_ID\", \"SALARY\", \"DEPARTMENT_NAME\")","commandVersion":91,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employees","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"EMPLOYEE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"FULL_NAME","nullable":false,"type":"string"},{"metadata":{},"name":"HIRE_DATE","nullable":true,"type":"date"},{"metadata":{},"name":"JOB_ID","nullable":true,"type":"string"},{"metadata":{},"name":"SALARY","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_NAME","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128738975,"submitTime":1667128738940,"finishTime":1667128739083,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1023287c-069b-40f7-b84e-fffa2aad9b74"},{"version":"CommandV1","origId":1137724266867246,"guid":"9ee7c21f-468d-4a2b-b777-6e06f56994a7","subtype":"command","commandType":"auto","position":31.5,"command":"employees.display()","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[100,"Steven King","2009-09-01","AD_PRES",24000,"Executive"],[101,"Neena Kochhar","2011-12-07","AD_VP",17000,"Executive"],[102,"Lex De Haan","2015-03-31","AD_VP",17000,"Executive"],[103,"Alexander Hunold","2012-03-20","IT_PROG",9000,"IT"],[104,"Bruce Ernst","2013-08-05","IT_PROG",6000,"IT"],[105,"David Austin","2019-09-10","IT_PROG",4800,"IT"],[106,"Valli Pataballa","2020-04-22","IT_PROG",4800,"IT"],[107,"Diana Lorentz","2021-04-24","IT_PROG",4200,"IT"],[108,"Nancy Greenberg","2016-11-01","FI_MGR",12000,"Finance"],[109,"Daniel Faviet","2016-10-31","FI_ACCOUNT",9000,"Finance"],[110,"John Chen","2019-12-14","FI_ACCOUNT",8200,"Finance"],[111,"Ismael Sciarra","2019-12-16","FI_ACCOUNT",7700,"Finance"],[112,"Jose Manuel Urman","2020-05-22","FI_ACCOUNT",7800,"Finance"],[113,"Luis Popp","2022-02-21","FI_ACCOUNT",6900,"Finance"],[114,"Den Raphaely","2017-02-21","PU_MAN",11000,"Purchasing"],[115,"Alexander Khoo","2017-08-02","PU_CLERK",3100,"Purchasing"],[116,"Shelli Baida","2020-03-10","PU_CLERK",2900,"Purchasing"],[117,"Sigal Tobias","2019-10-09","PU_CLERK",2800,"Purchasing"],[118,"Guy Himuro","2021-01-30","PU_CLERK",2600,"Purchasing"],[119,"Karen Colmenares","2021-10-25","PU_CLERK",2500,"Purchasing"],[120,"Matthew Weiss","2018-10-03","ST_MAN",8000,"Shipping"],[121,"Adam Fripp","2019-06-26","ST_MAN",8200,"Shipping"],[122,"Payam Kaufling","2017-07-16","ST_MAN",7900,"Shipping"],[123,"Shanta Vollman","2019-12-26","ST_MAN",6500,"Shipping"],[124,"Kevin Mourgos","2022-01-31","ST_MAN",5800,"Shipping"],[125,"Julia Nayer","2019-10-01","ST_CLERK",3200,"Shipping"],[126,"Irene Mikkilineni","2020-12-13","ST_CLERK",2700,"Shipping"],[127,"James Landry","2021-03-31","ST_CLERK",2400,"Shipping"],[128,"Steven Markle","2022-05-24","ST_CLERK",2200,"Shipping"],[129,"Laura Bissot","2019-11-05","ST_CLERK",3300,"Shipping"],[130,"Mozhe Atkinson","2020-01-15","ST_CLERK",2800,"Shipping"],[131,"James Marlow","2019-05-04","ST_CLERK",2500,"Shipping"],[132,"TJ Olson","2021-06-25","ST_CLERK",2100,"Shipping"],[133,"Jason Mallin","2018-08-30","ST_CLERK",3300,"Shipping"],[134,"Michael Rogers","2020-11-10","ST_CLERK",2900,"Shipping"],[135,"Ki Gee","2022-02-26","ST_CLERK",2400,"Shipping"],[136,"Hazel Philtanker","2022-04-23","ST_CLERK",2200,"Shipping"],[137,"Renske Ladwig","2017-09-28","ST_CLERK",3600,"Shipping"],[138,"Stephen Stiles","2020-01-11","ST_CLERK",3200,"Shipping"],[139,"John Seo","2020-04-29","ST_CLERK",2700,"Shipping"],[140,"Joshua Patel","2020-06-21","ST_CLERK",2500,"Shipping"],[141,"Trenna Rajs","2018-01-01","ST_CLERK",3500,"Shipping"],[142,"Curtis Davies","2019-04-16","ST_CLERK",3100,"Shipping"],[143,"Randall Matos","2020-05-30","ST_CLERK",2600,"Shipping"],[144,"Peter Vargas","2020-09-23","ST_CLERK",2500,"Shipping"],[145,"John Russell","2018-12-17","SA_MAN",14000,"Sales"],[146,"Karen Partners","2019-03-23","SA_MAN",13500,"Sales"],[147,"Alberto Errazuriz","2019-05-26","SA_MAN",12000,"Sales"],[148,"Gerald Cambrault","2021-12-30","SA_MAN",11000,"Sales"],[149,"Eleni Zlotkey","2022-04-15","SA_MAN",10500,"Sales"],[150,"Peter Tucker","2019-04-17","SA_REP",10000,"Sales"],[151,"David Bernstein","2019-06-09","SA_REP",9500,"Sales"],[152,"Peter Hall","2019-11-05","SA_REP",9000,"Sales"],[153,"Christopher Olsen","2020-06-14","SA_REP",8000,"Sales"],[154,"Nanette Cambrault","2021-02-23","SA_REP",7500,"Sales"],[155,"Oliver Tuvault","2022-02-07","SA_REP",7000,"Sales"],[156,"Janette King","2018-04-16","SA_REP",10000,"Sales"],[157,"Patrick Sully","2018-05-20","SA_REP",9500,"Sales"],[158,"Allan McEwen","2018-10-17","SA_REP",9000,"Sales"],[159,"Lindsey Smith","2019-05-26","SA_REP",8000,"Sales"],[160,"Louise Doran","2020-03-01","SA_REP",7500,"Sales"],[161,"Sarath Sewall","2021-01-18","SA_REP",7000,"Sales"],[162,"Clara Vishney","2020-01-27","SA_REP",10500,"Sales"],[163,"Danielle Greene","2021-06-03","SA_REP",9500,"Sales"],[164,"Mattea Marvins","2022-04-10","SA_REP",7200,"Sales"],[165,"David Lee","2022-05-10","SA_REP",6800,"Sales"],[166,"Sundar Ande","2022-06-09","SA_REP",6400,"Sales"],[167,"Amit Banda","2022-07-07","SA_REP",6200,"Sales"],[168,"Lisa Ozer","2019-05-27","SA_REP",11500,"Sales"],[169,"Harrison Bloom","2020-06-07","SA_REP",10000,"Sales"],[170,"Tayler Fox","2020-04-10","SA_REP",9600,"Sales"],[171,"William Smith","2021-05-10","SA_REP",7400,"Sales"],[172,"Elizabeth Bates","2021-06-08","SA_REP",7300,"Sales"],[173,"Sundita Kumar","2022-07-07","SA_REP",6100,"Sales"],[174,"Ellen Abel","2018-07-27","SA_REP",11000,"Sales"],[175,"Alyssa Hutton","2019-06-04","SA_REP",8800,"Sales"],[176,"Jonathon Taylor","2020-06-08","SA_REP",8600,"Sales"],[177,"Jack Livingston","2020-07-08","SA_REP",8400,"Sales"],[178,"Kimberely Grant","2021-08-08","SA_REP",7000,null],[179,"Charles Johnson","2022-03-21","SA_REP",6200,"Sales"],[180,"Winston Taylor","2020-04-10","SH_CLERK",3200,"Shipping"],[181,"Jean Fleaur","2020-05-10","SH_CLERK",3100,"Shipping"],[182,"Martha Sullivan","2021-09-05","SH_CLERK",2500,"Shipping"],[183,"Girard Geoni","2022-04-20","SH_CLERK",2800,"Shipping"],[184,"Nandita Sarchand","2018-04-13","SH_CLERK",4200,"Shipping"],[185,"Alexis Bull","2019-05-08","SH_CLERK",4100,"Shipping"],[186,"Julia Dellinger","2020-09-08","SH_CLERK",3400,"Shipping"],[187,"Anthony Cabrio","2021-04-24","SH_CLERK",3000,"Shipping"],[188,"Kelly Chung","2019-08-30","SH_CLERK",3800,"Shipping"],[189,"Jennifer Dilly","2019-10-29","SH_CLERK",3600,"Shipping"],[190,"Timothy Gates","2020-09-25","SH_CLERK",2900,"Shipping"],[191,"Randall Perkins","2022-03-05","SH_CLERK",2500,"Shipping"],[192,"Sarah Bell","2018-04-21","SH_CLERK",4000,"Shipping"],[193,"Britney Everett","2019-05-19","SH_CLERK",3900,"Shipping"],[194,"Samuel McCain","2020-09-15","SH_CLERK",3200,"Shipping"],[195,"Vance Jones","2021-06-01","SH_CLERK",2800,"Shipping"],[196,"Alana Walsh","2020-07-09","SH_CLERK",3100,"Shipping"],[197,"Kevin Feeney","2020-08-07","SH_CLERK",3000,"Shipping"],[198,"Donald OConnell","2021-09-05","SH_CLERK",2600,"Shipping"],[199,"Douglas Grant","2022-03-30","SH_CLERK",2600,"Shipping"],[200,"Jennifer Whalen","2009-12-02","AD_ASST",4400,"Administration"],[201,"Michael Hartstein","2018-05-04","MK_MAN",13000,"Marketing"],[202,"Pat Fay","2019-11-02","MK_REP",6000,"Marketing"],[203,"Susan Mavris","2016-08-22","HR_REP",6500,"Human Resources"],[204,"Hermann Baer","2016-08-22","PR_REP",10000,"Public Relations"],[205,"Shelley Higgins","2016-08-22","AC_MGR",12000,"Accounting"],[206,"William Gietz","2016-08-22","AC_ACCOUNT",8300,"Accounting"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"EMPLOYEE_ID","type":"\"integer\"","metadata":"{}"},{"name":"FULL_NAME","type":"\"string\"","metadata":"{}"},{"name":"HIRE_DATE","type":"\"date\"","metadata":"{}"},{"name":"JOB_ID","type":"\"string\"","metadata":"{}"},{"name":"SALARY","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128752851,"submitTime":1667128752827,"finishTime":1667128754354,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",107]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b21c78d7-39af-4a5e-9afe-f22be7f3e40d"},{"version":"CommandV1","origId":1137724266867247,"guid":"4d46a38e-39b6-4155-bd67-0fefdff9e3d2","subtype":"command","commandType":"auto","position":32.0,"command":"# Writing the employees dataframe to the gold layer\nemployees.write.parquet(\"/mnt/employees/gold/employees\")","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128760690,"submitTime":1667128760667,"finishTime":1667128761805,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"65989138-6efb-4b9f-8b4e-1761e3147bfe"},{"version":"CommandV1","origId":1137724266867248,"guid":"b9f2df07-02da-4a81-8636-3df552c41b2e","subtype":"command","commandType":"auto","position":36.0,"command":"%md\n#### Creating the employees database and loading the gold layer table","commandVersion":14,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2bb80163-42e5-4dc1-b382-361436bb1a47"},{"version":"CommandV1","origId":1137724266867249,"guid":"4f5d0b60-7a70-4883-8822-3b42ec961e68","subtype":"command","commandType":"auto","position":37.0,"command":"%sql\nCREATE DATABASE IF NOT EXISTS employees;","commandVersion":17,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128796660,"submitTime":1667128796636,"finishTime":1667128797424,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6c00f621-83c7-41e7-90a4-3d1bcf196bab"},{"version":"CommandV1","origId":1137724266867250,"guid":"753c7748-db25-4e3d-a817-6bc6f0405e98","subtype":"command","commandType":"auto","position":38.0,"command":"%sql\nCREATE TABLE employees.employees \n(\n  EMPLOYEE_ID int,\n  FULL_NAME string,\n  HIRE_DATE date, \n  JOB_ID string,\n  SALARY int,\n  DEPARTMENT_NAME string\n  )\nUSING parquet\nLOCATION '/mnt/employees/gold/employees'\n\n","commandVersion":67,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128820506,"submitTime":1667128820470,"finishTime":1667128821640,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e7cccb25-adb7-4393-aeb7-d5cb4ce604d4"},{"version":"CommandV1","origId":1137724266867251,"guid":"3ac84756-c5a1-4627-a968-3b063e1d6163","subtype":"command","commandType":"auto","position":39.0,"command":"%sql\nSELECT * FROM employees.employees;","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[100,"Steven King","2009-09-01","AD_PRES",24000,"Executive"],[101,"Neena Kochhar","2011-12-07","AD_VP",17000,"Executive"],[102,"Lex De Haan","2015-03-31","AD_VP",17000,"Executive"],[103,"Alexander Hunold","2012-03-20","IT_PROG",9000,"IT"],[104,"Bruce Ernst","2013-08-05","IT_PROG",6000,"IT"],[105,"David Austin","2019-09-10","IT_PROG",4800,"IT"],[106,"Valli Pataballa","2020-04-22","IT_PROG",4800,"IT"],[107,"Diana Lorentz","2021-04-24","IT_PROG",4200,"IT"],[108,"Nancy Greenberg","2016-11-01","FI_MGR",12000,"Finance"],[109,"Daniel Faviet","2016-10-31","FI_ACCOUNT",9000,"Finance"],[110,"John Chen","2019-12-14","FI_ACCOUNT",8200,"Finance"],[111,"Ismael Sciarra","2019-12-16","FI_ACCOUNT",7700,"Finance"],[112,"Jose Manuel Urman","2020-05-22","FI_ACCOUNT",7800,"Finance"],[113,"Luis Popp","2022-02-21","FI_ACCOUNT",6900,"Finance"],[114,"Den Raphaely","2017-02-21","PU_MAN",11000,"Purchasing"],[115,"Alexander Khoo","2017-08-02","PU_CLERK",3100,"Purchasing"],[116,"Shelli Baida","2020-03-10","PU_CLERK",2900,"Purchasing"],[117,"Sigal Tobias","2019-10-09","PU_CLERK",2800,"Purchasing"],[118,"Guy Himuro","2021-01-30","PU_CLERK",2600,"Purchasing"],[119,"Karen Colmenares","2021-10-25","PU_CLERK",2500,"Purchasing"],[120,"Matthew Weiss","2018-10-03","ST_MAN",8000,"Shipping"],[121,"Adam Fripp","2019-06-26","ST_MAN",8200,"Shipping"],[122,"Payam Kaufling","2017-07-16","ST_MAN",7900,"Shipping"],[123,"Shanta Vollman","2019-12-26","ST_MAN",6500,"Shipping"],[124,"Kevin Mourgos","2022-01-31","ST_MAN",5800,"Shipping"],[125,"Julia Nayer","2019-10-01","ST_CLERK",3200,"Shipping"],[126,"Irene Mikkilineni","2020-12-13","ST_CLERK",2700,"Shipping"],[127,"James Landry","2021-03-31","ST_CLERK",2400,"Shipping"],[128,"Steven Markle","2022-05-24","ST_CLERK",2200,"Shipping"],[129,"Laura Bissot","2019-11-05","ST_CLERK",3300,"Shipping"],[130,"Mozhe Atkinson","2020-01-15","ST_CLERK",2800,"Shipping"],[131,"James Marlow","2019-05-04","ST_CLERK",2500,"Shipping"],[132,"TJ Olson","2021-06-25","ST_CLERK",2100,"Shipping"],[133,"Jason Mallin","2018-08-30","ST_CLERK",3300,"Shipping"],[134,"Michael Rogers","2020-11-10","ST_CLERK",2900,"Shipping"],[135,"Ki Gee","2022-02-26","ST_CLERK",2400,"Shipping"],[136,"Hazel Philtanker","2022-04-23","ST_CLERK",2200,"Shipping"],[137,"Renske Ladwig","2017-09-28","ST_CLERK",3600,"Shipping"],[138,"Stephen Stiles","2020-01-11","ST_CLERK",3200,"Shipping"],[139,"John Seo","2020-04-29","ST_CLERK",2700,"Shipping"],[140,"Joshua Patel","2020-06-21","ST_CLERK",2500,"Shipping"],[141,"Trenna Rajs","2018-01-01","ST_CLERK",3500,"Shipping"],[142,"Curtis Davies","2019-04-16","ST_CLERK",3100,"Shipping"],[143,"Randall Matos","2020-05-30","ST_CLERK",2600,"Shipping"],[144,"Peter Vargas","2020-09-23","ST_CLERK",2500,"Shipping"],[145,"John Russell","2018-12-17","SA_MAN",14000,"Sales"],[146,"Karen Partners","2019-03-23","SA_MAN",13500,"Sales"],[147,"Alberto Errazuriz","2019-05-26","SA_MAN",12000,"Sales"],[148,"Gerald Cambrault","2021-12-30","SA_MAN",11000,"Sales"],[149,"Eleni Zlotkey","2022-04-15","SA_MAN",10500,"Sales"],[150,"Peter Tucker","2019-04-17","SA_REP",10000,"Sales"],[151,"David Bernstein","2019-06-09","SA_REP",9500,"Sales"],[152,"Peter Hall","2019-11-05","SA_REP",9000,"Sales"],[153,"Christopher Olsen","2020-06-14","SA_REP",8000,"Sales"],[154,"Nanette Cambrault","2021-02-23","SA_REP",7500,"Sales"],[155,"Oliver Tuvault","2022-02-07","SA_REP",7000,"Sales"],[156,"Janette King","2018-04-16","SA_REP",10000,"Sales"],[157,"Patrick Sully","2018-05-20","SA_REP",9500,"Sales"],[158,"Allan McEwen","2018-10-17","SA_REP",9000,"Sales"],[159,"Lindsey Smith","2019-05-26","SA_REP",8000,"Sales"],[160,"Louise Doran","2020-03-01","SA_REP",7500,"Sales"],[161,"Sarath Sewall","2021-01-18","SA_REP",7000,"Sales"],[162,"Clara Vishney","2020-01-27","SA_REP",10500,"Sales"],[163,"Danielle Greene","2021-06-03","SA_REP",9500,"Sales"],[164,"Mattea Marvins","2022-04-10","SA_REP",7200,"Sales"],[165,"David Lee","2022-05-10","SA_REP",6800,"Sales"],[166,"Sundar Ande","2022-06-09","SA_REP",6400,"Sales"],[167,"Amit Banda","2022-07-07","SA_REP",6200,"Sales"],[168,"Lisa Ozer","2019-05-27","SA_REP",11500,"Sales"],[169,"Harrison Bloom","2020-06-07","SA_REP",10000,"Sales"],[170,"Tayler Fox","2020-04-10","SA_REP",9600,"Sales"],[171,"William Smith","2021-05-10","SA_REP",7400,"Sales"],[172,"Elizabeth Bates","2021-06-08","SA_REP",7300,"Sales"],[173,"Sundita Kumar","2022-07-07","SA_REP",6100,"Sales"],[174,"Ellen Abel","2018-07-27","SA_REP",11000,"Sales"],[175,"Alyssa Hutton","2019-06-04","SA_REP",8800,"Sales"],[176,"Jonathon Taylor","2020-06-08","SA_REP",8600,"Sales"],[177,"Jack Livingston","2020-07-08","SA_REP",8400,"Sales"],[178,"Kimberely Grant","2021-08-08","SA_REP",7000,null],[179,"Charles Johnson","2022-03-21","SA_REP",6200,"Sales"],[180,"Winston Taylor","2020-04-10","SH_CLERK",3200,"Shipping"],[181,"Jean Fleaur","2020-05-10","SH_CLERK",3100,"Shipping"],[182,"Martha Sullivan","2021-09-05","SH_CLERK",2500,"Shipping"],[183,"Girard Geoni","2022-04-20","SH_CLERK",2800,"Shipping"],[184,"Nandita Sarchand","2018-04-13","SH_CLERK",4200,"Shipping"],[185,"Alexis Bull","2019-05-08","SH_CLERK",4100,"Shipping"],[186,"Julia Dellinger","2020-09-08","SH_CLERK",3400,"Shipping"],[187,"Anthony Cabrio","2021-04-24","SH_CLERK",3000,"Shipping"],[188,"Kelly Chung","2019-08-30","SH_CLERK",3800,"Shipping"],[189,"Jennifer Dilly","2019-10-29","SH_CLERK",3600,"Shipping"],[190,"Timothy Gates","2020-09-25","SH_CLERK",2900,"Shipping"],[191,"Randall Perkins","2022-03-05","SH_CLERK",2500,"Shipping"],[192,"Sarah Bell","2018-04-21","SH_CLERK",4000,"Shipping"],[193,"Britney Everett","2019-05-19","SH_CLERK",3900,"Shipping"],[194,"Samuel McCain","2020-09-15","SH_CLERK",3200,"Shipping"],[195,"Vance Jones","2021-06-01","SH_CLERK",2800,"Shipping"],[196,"Alana Walsh","2020-07-09","SH_CLERK",3100,"Shipping"],[197,"Kevin Feeney","2020-08-07","SH_CLERK",3000,"Shipping"],[198,"Donald OConnell","2021-09-05","SH_CLERK",2600,"Shipping"],[199,"Douglas Grant","2022-03-30","SH_CLERK",2600,"Shipping"],[200,"Jennifer Whalen","2009-12-02","AD_ASST",4400,"Administration"],[201,"Michael Hartstein","2018-05-04","MK_MAN",13000,"Marketing"],[202,"Pat Fay","2019-11-02","MK_REP",6000,"Marketing"],[203,"Susan Mavris","2016-08-22","HR_REP",6500,"Human Resources"],[204,"Hermann Baer","2016-08-22","PR_REP",10000,"Public Relations"],[205,"Shelley Higgins","2016-08-22","AC_MGR",12000,"Accounting"],[206,"William Gietz","2016-08-22","AC_ACCOUNT",8300,"Accounting"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"EMPLOYEE_ID","type":"\"integer\"","metadata":"{}"},{"name":"FULL_NAME","type":"\"string\"","metadata":"{}"},{"name":"HIRE_DATE","type":"\"date\"","metadata":"{}"},{"name":"JOB_ID","type":"\"string\"","metadata":"{}"},{"name":"SALARY","type":"\"integer\"","metadata":"{}"},{"name":"DEPARTMENT_NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"EMPLOYEE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"FULL_NAME","nullable":true,"type":"string"},{"metadata":{},"name":"HIRE_DATE","nullable":true,"type":"date"},{"metadata":{},"name":"JOB_ID","nullable":true,"type":"string"},{"metadata":{},"name":"SALARY","nullable":true,"type":"integer"},{"metadata":{},"name":"DEPARTMENT_NAME","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128842622,"submitTime":1667128842599,"finishTime":1667128843134,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",107]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"72f7d9c8-f6e6-4dd0-9034-d4d3e9d8cab0"},{"version":"CommandV1","origId":1137724266867252,"guid":"84a382e8-c7c7-4913-92a1-1bbdb370bc9e","subtype":"command","commandType":"auto","position":40.0,"command":"%sql\n\nDESCRIBE EXTENDED employees.employees","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["EMPLOYEE_ID","int",null],["FULL_NAME","string",null],["HIRE_DATE","date",null],["JOB_ID","string",null],["SALARY","int",null],["DEPARTMENT_NAME","string",null],["","",""],["# Detailed Table Information","",""],["Database","employees",""],["Table","employees",""],["Owner","root",""],["Created Time","Sun Oct 30 11:20:21 UTC 2022",""],["Last Access","UNKNOWN",""],["Created By","Spark 3.2.1",""],["Type","EXTERNAL",""],["Provider","parquet",""],["Location","dbfs:/mnt/employees/gold/employees",""],["Serde Library","org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe",""],["InputFormat","org.apache.hadoop.mapred.SequenceFileInputFormat",""],["OutputFormat","org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",""]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_name","type":"\"string\"","metadata":"{\"comment\":\"name of the column\"}"},{"name":"data_type","type":"\"string\"","metadata":"{\"comment\":\"data type of the column\"}"},{"name":"comment","type":"\"string\"","metadata":"{\"comment\":\"comment of the column\"}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"comment":"name of the column"},"name":"col_name","nullable":false,"type":"string"},{"metadata":{"comment":"data type of the column"},"name":"data_type","nullable":false,"type":"string"},{"metadata":{"comment":"comment of the column"},"name":"comment","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667128861179,"submitTime":1667128861157,"finishTime":1667128861327,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",20]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"17a4f99b-8890-4ba3-ae41-2f8222f59b11"}],"dashboards":[],"guid":"209b08dc-6018-4985-b0e9-67b214c1f482","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":1472154042299316,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE"}