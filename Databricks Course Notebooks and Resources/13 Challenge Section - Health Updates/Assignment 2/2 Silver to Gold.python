{"version":"NotebookV1","origId":1137724266867268,"name":"2 Silver to Gold","language":"python","commands":[{"version":"CommandV1","origId":1137724266867269,"guid":"16b81868-d98b-49d2-8aaf-91aeceb3284a","subtype":"command","commandType":"auto","position":1.0,"command":"# Reading in the silver table into a dataframe\nhealth_data = spark.read.format(\"delta\").load(\"/mnt/health-updates/silver/health_data\")","commandVersion":34,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"health_data","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"STATUS_UPDATE_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"PATIENT_ID","nullable":true,"type":"integer"},{"metadata":{},"name":"DATE_PROVIDED","nullable":true,"type":"date"},{"metadata":{},"name":"FEELING_TODAY","nullable":true,"type":"string"},{"metadata":{},"name":"IMPACT","nullable":true,"type":"string"},{"metadata":{},"name":"INJECTION_SITE_SYMPTOMS","nullable":true,"type":"string"},{"metadata":{},"name":"HIGHEST_TEMP","nullable":true,"type":"double"},{"metadata":{},"name":"FEVERISH_TODAY","nullable":true,"type":"string"},{"metadata":{},"name":"GENERAL_SYMPTOMS","nullable":true,"type":"string"},{"metadata":{},"name":"HEALTHCARE_VISIT","nullable":true,"type":"string"},{"metadata":{},"name":"UPDATED_TIMESTAMP","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":"dbfs:/mnt/health-updates/silver/health_data"}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667733245630,"submitTime":1667733244493,"finishTime":1667733245800,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"acc17c5c-ce46-497a-9651-0c9a401dd1db"},{"version":"CommandV1","origId":1137724266867270,"guid":"b10ea73e-3b69-4744-b2cd-e8314b01a2e1","subtype":"command","commandType":"auto","position":2.0,"command":"# creating the feeling_count_day dataframe\nfeeling_count_day = health_data.groupBy(\"date_provided\",\"feeling_today\").count()","commandVersion":79,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"feeling_count_day","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"date_provided","nullable":true,"type":"date"},{"metadata":{},"name":"feeling_today","nullable":true,"type":"string"},{"metadata":{},"name":"count","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667733256944,"submitTime":1667733256926,"finishTime":1667733256983,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7a5661a1-1214-4b5b-b19c-3c34a52b79f3"},{"version":"CommandV1","origId":1137724266867271,"guid":"cd69418d-6228-4e02-b848-e9df478024d0","subtype":"command","commandType":"auto","position":2.5,"command":"# writing the feeling_count_day dataframe as a gold layer table and saving it as an external table\nfeeling_count_day.write.format(\"delta\").mode(\"overwrite\").option(\"path\",\"/mnt/health-updates/gold/feeling_count_day\").saveAsTable(\"healthcare.feeling_count_day\")","commandVersion":31,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667733288222,"submitTime":1667733288205,"finishTime":1667733291149,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"79a6c025-6102-4712-b054-9092fc81e585"},{"version":"CommandV1","origId":1137724266867272,"guid":"ed29918d-3726-460c-83cd-fe0005217d3b","subtype":"command","commandType":"auto","position":3.0,"command":"# creating the symptom_count_day dataframe\nsymptoms_count_day = health_data.groupBy(\"date_provided\",\"GENERAL_SYMPTOMS\").count()","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"symptoms_count_day","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"date_provided","nullable":true,"type":"date"},{"metadata":{},"name":"GENERAL_SYMPTOMS","nullable":true,"type":"string"},{"metadata":{},"name":"count","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667733293918,"submitTime":1667733293899,"finishTime":1667733293957,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"617c6d14-6779-47c0-a48d-e0807867ca02"},{"version":"CommandV1","origId":1137724266867273,"guid":"2ca96505-e233-4797-851e-f75d3e2b4ee1","subtype":"command","commandType":"auto","position":3.5,"command":"# writing the symptom_count_day dataframe as a gold layer table and saving it as an external table\nsymptoms_count_day.write.format(\"delta\").mode(\"overwrite\").option(\"path\",\"/mnt/health-updates/gold/symptoms_count_day\").saveAsTable(\"healthcare.symptoms_count_day\")","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667733294636,"submitTime":1667733294619,"finishTime":1667733297259,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"43ceb01f-cacc-4c63-8ded-4f2afa410d88"},{"version":"CommandV1","origId":1137724266867274,"guid":"f7478a2d-8e03-4465-9e49-7ec181fe1041","subtype":"command","commandType":"auto","position":4.0,"command":"# creating the healthcare_visit_day dataframe\nhealthcare_visit_day = health_data.groupBy(\"date_provided\",\"healthcare_visit\").count()","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"healthcare_visit_day","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"date_provided","nullable":true,"type":"date"},{"metadata":{},"name":"healthcare_visit","nullable":true,"type":"string"},{"metadata":{},"name":"count","nullable":false,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667733297263,"submitTime":1667733295366,"finishTime":1667733297299,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6e814c4c-f813-4403-b430-f1da17f8e11a"},{"version":"CommandV1","origId":1137724266867275,"guid":"2c6b5342-9691-4d04-b2fd-b92cc0402429","subtype":"command","commandType":"auto","position":5.0,"command":"# writing the healthcare_visit_day dataframe as a gold layer table and saving it as an external table\nhealthcare_visit_day.write.format(\"delta\").mode(\"overwrite\").option(\"path\",\"/mnt/health-updates/gold/healthcare_visit_day\").saveAsTable(\"healthcare.healthcare_visit_day\")","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1667733302453,"submitTime":1667733302429,"finishTime":1667733304974,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"17c7cd9e-5d22-43a3-99fe-b2ac8298f2ab"},{"version":"CommandV1","origId":1137724266867276,"guid":"71e97044-a0bf-433b-a487-9877864c36b3","subtype":"command","commandType":"auto","position":6.0,"command":"dbutils.notebook.exit(\"Gold Processing Complete\")","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"80fce1eb-a0da-47b8-9cf1-489dcc6022e0"}],"dashboards":[],"guid":"8f5fbe7d-6144-4e69-9513-cab16a961f5a","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":-1,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE"}