{"version":"NotebookV1","origId":1137724266866793,"name":"02 Accessing Data via SAS Token","language":"python","commands":[{"version":"CommandV1","origId":1137724266866794,"guid":"b03a78ea-abf4-47fa-8785-f1b4fa561ebd","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n# Accessing Data via SAS Token\n\n#### Resources:\n* https://learn.microsoft.com/en-us/azure/databricks/external-data/azure-storage#access-azure-data-lake-storage-gen2-or-blob-storage-using-a-sas-token\n* https://learn.microsoft.com/en-us/azure/storage/blobs/data-lake-storage-introduction-abfs-uri","commandVersion":16,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"89f75d31-a932-4b1c-8eb8-eb5613ae9d00"},{"version":"CommandV1","origId":1137724266866795,"guid":"445fcad9-dc2a-4420-a597-1f563137407b","subtype":"command","commandType":"auto","position":1.0,"command":"# Setting the configuration\nspark.conf.set(\"fs.azure.account.auth.type.datalake639.dfs.core.windows.net\", \"SAS\")\nspark.conf.set(\"fs.azure.sas.token.provider.type.datalake639.dfs.core.windows.net\", \"org.apache.hadoop.fs.azurebfs.sas.FixedSASTokenProvider\")\nspark.conf.set(\"fs.azure.sas.fixed.token.datalake639.dfs.core.windows.net\", \"INSERT SAS TOKEN HERE\")","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1666783968444,"submitTime":1666783968374,"finishTime":1666783968476,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["html",27]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d15b26e5-91f4-42ca-b6a6-acdd087342d6"},{"version":"CommandV1","origId":1137724266866796,"guid":"c683a390-dcdd-455d-8c55-c5f24561e23b","subtype":"command","commandType":"auto","position":2.0,"command":"# Reading data from storage account\nspark.read.csv(\"abfss://<INSERT CONTAINER NAME>@<INSERT STORAGE ACCOUNT NAME>.dfs.core.windows.net/country_regions.csv\", header=True).display()","commandVersion":36,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["10","America"],["20","Europe"],["30","Asia"],["40","Oceania"],["50","Africa"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"ID","type":"\"string\"","metadata":"{}"},{"name":"NAME","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1666784016807,"submitTime":1666784016777,"finishTime":1666784017270,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",5]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a373fc1a-f8f1-4424-b954-78a70225fcca"}],"dashboards":[],"guid":"3c262fb2-a89b-44c4-89e7-fbe357dbd766","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE"}